(function(e){function t(t){for(var n,i,s=t[0],c=t[1],l=t[2],u=0,h=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&h.push(r[i][0]),r[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(h.length)h.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var c=a[s];0!==r[c]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},o=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=c;o.push([1,"chunk-vendors"]),a()})({0:function(e,t){},"034f":function(e,t,a){"use strict";var n=a("8a23"),r=a.n(n);r.a},1:function(e,t,a){e.exports=a("cd49")},2:function(e,t){},3:function(e,t){},"3ab7":function(e,t,a){"use strict";var n=a("4a7e"),r=a.n(n);r.a},4230:function(e,t,a){},"4a7e":function(e,t,a){},"8a23":function(e,t,a){},"8c83":function(e,t,a){},"9e3e":function(e,t,a){"use strict";(function(e){a("b0c0"),a("ac1f"),a("5319");var n=a("53ca"),r="object"===("undefined"===typeof window?"undefined":Object(n["a"])(window))&&window.window===window?window:"object"===("undefined"===typeof self?"undefined":Object(n["a"])(self))&&self.self===self?self:"object"===("undefined"===typeof e?"undefined":Object(n["a"])(e))&&e.global===e?e:void 0;function o(e,t){return"undefined"===typeof t?t={autoBom:!1}:"object"!==Object(n["a"])(t)&&(t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function i(e,t,a){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){d(n.response,t,a)},n.onerror=function(){alert("Error: could not download file!")},n.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(a){}return t.status>=200&&t.status<=299}function c(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),d="object"!==("undefined"===typeof window?"undefined":Object(n["a"])(window))||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,a){var n=r.URL||r.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener","string"===typeof e?(o.href=e,o.origin!==location.origin?s(o.href)?i(e,t,a):c(o,o.target="_blank"):c(o)):(o.href=n.createObjectURL(e),setTimeout((function(){n.revokeObjectURL(o.href)}),4e4),setTimeout((function(){c(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,a){if(t=t||e.name||"download","string"===typeof e)if(s(e))i(e,t,a);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout((function(){c(n)}))}else navigator.msSaveOrOpenBlob(o(e,a),t)}:function(e,t,a,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"===typeof e)return i(e,t,a);var o="application/octet-stream"===e.type,s=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&s||l)&&"undefined"!==typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var u=r.URL||r.webkitURL,h=u.createObjectURL(e);n?n.location=h:location.href=h,n=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}};t["a"]=d}).call(this,a("c8ba"))},b396:function(e,t,a){"use strict";var n=a("8c83"),r=a.n(n);r.a},cccb:function(e,t,a){"use strict";var n=a("4230"),r=a.n(n);r.a},cd49:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{attrs:{dark:""}},[a("Header"),a("v-content",{staticStyle:{"margin-top":"20px"}},[a("router-view")],1),a("Footer")],1)},o=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.$vuetify.breakpoint.xsOnly?a("v-navigation-drawer",{attrs:{clipped:"","mobile-break-point":"600",width:"180"},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-list",{attrs:{shaped:""}},e._l(e.navList,(function(t,n){return a("v-list-tile",{key:n,attrs:{to:t.url,draggable:!1},on:{click:function(t){e.drawer=!1}}},[t.icon?a("v-list-tile-action",{staticStyle:{"margin-right":"0px"}},[a("v-icon",[e._v(e._s(t.icon||"grip-lines"))])],1):e._e(),a("v-list-tile-content",[a("v-list-tile-title",{staticStyle:{"font-size":"120%"}},[e._v(" "+e._s(t.name)+" ")])],1)],1)})),1)],1):e._e(),a("v-toolbar",[e.$vuetify.breakpoint.xsOnly?a("span",[a("div",{on:{click:function(t){e.drawer=!e.drawer}}},[a("v-icon",[e._v("fa-bars")])],1)]):e._e(),a("v-toolbar-title",{staticClass:"headline"},[a("router-link",{staticClass:"header-logo",staticStyle:{"text-decoration":"none"},attrs:{to:"/"}},[a("span",[e._v("JSCARA")])])],1),e.$vuetify.breakpoint.smAndUp?a("v-spacer"):e._e(),e.$vuetify.breakpoint.smAndUp?a("span",e._l(e.navList,(function(t,n){return a("v-btn",{key:n,staticClass:"header-nav",attrs:{to:t.url}},[a("span",{staticClass:"mr-2"},[e._v(e._s(t.name))]),a("v-icon",[e._v("fas "+e._s(t.icon))])],1)})),1):e._e()],1)],1)},s=[],c=n["default"].extend({data:function(){return{drawer:!1}},computed:{navList:function(){var e=[];return e}}}),l=c,d=(a("3ab7"),a("2877")),u=a("6544"),h=a.n(u),p=a("8336"),f=a("132d"),_=a("8860"),v=a("f774"),g=a("2fa4"),m=a("71d9"),b=a("2a7f"),w=Object(d["a"])(l,i,s,!1,null,"71fb3f7b",null),x=w.exports;h()(w,{VBtn:p["a"],VIcon:f["a"],VList:_["a"],VNavigationDrawer:v["a"],VSpacer:g["a"],VToolbar:m["a"],VToolbarTitle:b["a"]});var y=n["default"].extend({name:"App",components:{Header:x}}),k=y,S=(a("034f"),a("7496")),M=a("a75b"),C=Object(d["a"])(k,r,o,!1,null,null,null),O=C.exports;h()(C,{VApp:S["a"],VContent:M["a"]});var G=a("8c4f"),j=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"margin-left":"24px"},attrs:{id:"serial-pane"}},[e._m(0),void 0===e.reader||void 0===e.output_stream?a("div",[e.attempting_to_connect?a("v-btn",{attrs:{color:"error"},on:{click:function(t){e.cancel_connect=!0}}},[e._v(" Cancel Connect to SCARA ")]):a("v-btn",{attrs:{color:"primary"},on:{click:e.serial_connect}},[e._v(" Connect to SCARA ")])],1):a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("v-text-field",{staticStyle:{"max-width":"500px","margin-right":"30px"},attrs:{label:"GCODE Command",outlined:"",autocomplete:"off"},nativeOn:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.write_cmd_to_serial(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.recover_prev_cmd(1)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.recover_prev_cmd(-1)}]},model:{value:e.cmd,callback:function(t){e.cmd=t},expression:"cmd"}}),a("v-btn",{staticStyle:{transform:"scale(1.2)"},on:{click:e.write_cmd_to_serial}},[e._v(" Send ")])],1),void 0!==e.reader&&void 0!==e.output_stream?a("div",[a("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:e.home_scara}},[e._v(" Origin ")]),a("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(t){return e.write_serial("G92 X0 Y0\n")}}},[e._v(" XY=0 ")]),a("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(t){return e.write_serial("G92 Z0\n")}}},[e._v(" Z=0 ")]),a("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(t){return e.write_serial("G92 X0 Y0 Z0\n")}}},[e._v(" XYZ=0 ")]),a("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(t){return e.write_serial("M18\n")}}},[e._v(" Release Steppers ")]),a("div",{staticStyle:{display:"flex","align-items":"stretch"}},[a("div",{staticClass:"jog-box"},[a("div",{staticClass:"jog-col"},[a("v-text-field",{staticStyle:{"text-align":"center"},attrs:{type:"number",step:"5"},model:{value:e.jog_inc["x"],callback:function(t){e.$set(e.jog_inc,"x",e._n(t))},expression:"jog_inc['x']"}}),a("v-btn",{staticClass:"jog-btn",on:{click:function(t){return e.write_serial("G91\nG0 X"+e.jog_inc["x"]+"\nG90\n")}}},[e._v(" +X ")]),a("v-btn",{staticClass:"jog-btn",on:{click:function(t){return e.write_serial("G91\nG0 X-"+e.jog_inc["x"]+"\nG90\n")}}},[e._v(" -X ")])],1),a("div",{staticClass:"jog-col"},[a("v-text-field",{staticStyle:{"text-align":"center"},attrs:{type:"number",step:"5"},model:{value:e.jog_inc["y"],callback:function(t){e.$set(e.jog_inc,"y",e._n(t))},expression:"jog_inc['y']"}}),a("v-btn",{staticClass:"jog-btn",on:{click:function(t){return e.write_serial("G91\nG0 Y"+e.jog_inc["y"]+"\nG90\n")}}},[e._v(" +Y ")]),a("v-btn",{staticClass:"jog-btn",on:{click:function(t){return e.write_serial("G91\nG0 Y-"+e.jog_inc["y"]+"\nG90\n")}}},[e._v(" -Y ")])],1),a("div",{staticClass:"jog-col"},[a("v-text-field",{staticStyle:{"text-align":"center"},attrs:{type:"number",step:"5"},model:{value:e.jog_inc["z"],callback:function(t){e.$set(e.jog_inc,"z",e._n(t))},expression:"jog_inc['z']"}}),a("v-btn",{staticClass:"jog-btn",on:{click:function(t){e.write_serial("G91\nG0 Z"+Math.max(1,e.jog_inc["z"])+"\nG90\n")}}},[e._v(" +Z ")]),a("v-btn",{staticClass:"jog-btn",on:{click:function(t){e.write_serial("G91\nG0 Z-"+Math.max(1,e.jog_inc["z"])+"\nG90\n")}}},[e._v(" -Z ")])],1)]),a("div",{staticStyle:{width:"240px",margin:"10px 20px",padding:"16px 30px","background-color":"#ffb8b8","border-radius":"10px",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},[a("v-row",[a("v-text-field",{staticStyle:{width:"100px"},attrs:{type:"number",label:"X Position"},model:{value:e.goto.x,callback:function(t){e.$set(e.goto,"x",e._n(t))},expression:"goto.x"}}),a("div"),a("v-text-field",{staticStyle:{width:"100px"},attrs:{type:"number",label:"Y Position"},model:{value:e.goto.y,callback:function(t){e.$set(e.goto,"y",e._n(t))},expression:"goto.y"}})],1),a("v-row",{attrs:{justify:"center"}},[a("v-btn",{on:{click:e.goto_point}},[e._v("Go To")])],1)],1)]),a("v-text-field",{staticStyle:{width:"100px"},attrs:{type:"number",label:"X Offset"},model:{value:e.scara_conv.x_offset,callback:function(t){e.$set(e.scara_conv,"x_offset",e._n(t))},expression:"scara_conv.x_offset"}}),a("v-text-field",{staticStyle:{width:"100px"},attrs:{type:"number",label:"Y Offset"},model:{value:e.scara_conv.y_offset,callback:function(t){e.$set(e.scara_conv,"y_offset",e._n(t))},expression:"scara_conv.y_offset"}}),e._v(" Working Area: "+e._s(e.work_area_dim)+" x "+e._s(e.work_area_dim)+" ")],1):e._e(),a("div",{staticStyle:{"margin-top":"14px","min-height":"40vh","max-height":"60vh",width:"90%","overflow-y":"scroll",border:"1px dotted #333"}},e._l(e.serial_log,(function(t,n){return a("span",{key:n,domProps:{innerHTML:e._s(t)}})})),0),a("v-expansion-panels",[a("v-expansion-panel",[a("v-expansion-panel-header",{attrs:{color:"#333"}},[e._v(" Text 🢂 SCARA ")]),a("v-expansion-panel-content",[a("TextToGcode",{on:{gcodegen:e.gcode_from_text}}),a("br"),e.converted_gcode.length>0?a("v-btn",{on:{click:e.send_converted_gcode}},[e._v(" Send Converted GCODE ")]):e._e(),e.raw_gcode.length>0?a("v-btn",{on:{click:e.regen_converted_gcode}},[e._v(" Regen SCARA GCODE ")]):e._e(),e.send_buffer.length>0?a("v-btn",{on:{click:e.write_next_in_buffer_to_serial}},[e._v(" Unclog Stuck Buffer ")]):e._e(),e.send_buffer.length>0?a("v-btn",{on:{click:e.clear_buffer}},[e._v(" Clear Buffer ")]):e._e()],1)],1),a("v-expansion-panel",[a("v-expansion-panel-header",{attrs:{color:"#333"}},[e._v(" Image 🢂 SCARA ")]),a("v-expansion-panel-content",[a("ImgToGcode",{on:{gcodegen:e.gcode_from_text}}),a("br"),e.converted_gcode.length>0?a("v-btn",{on:{click:e.send_converted_gcode}},[e._v(" Send Converted GCODE ")]):e._e(),e.raw_gcode.length>0?a("v-btn",{on:{click:e.regen_converted_gcode}},[e._v(" Regen SCARA GCODE ")]):e._e(),e.send_buffer.length>0?a("v-btn",{on:{click:e.write_next_in_buffer_to_serial}},[e._v(" Unclog Stuck Buffer ")]):e._e(),e.send_buffer.length>0?a("v-btn",{on:{click:e.clear_buffer}},[e._v(" Clear Buffer ")]):e._e(),e.converted_gcode.length>0?a("v-btn",{on:{click:function(t){return e.saveGcode(e.raw_gcode)}}},[e._v(" Save Raw GCODE ")]):e._e()],1)],1),a("v-expansion-panel",[a("v-expansion-panel-header",[e._v(" GCode Uploader ")]),a("v-expansion-panel-content",[a("v-file-input",{attrs:{placeholder:"Upload Cartesian GCODE"},on:{change:e.load_gcode_file}}),a("br"),e.converted_gcode.length>0?a("v-btn",{on:{click:e.send_converted_gcode}},[e._v(" Send Converted GCODE ")]):e._e(),e.raw_gcode.length>0?a("v-btn",{on:{click:e.regen_converted_gcode}},[e._v(" Regen SCARA GCODE ")]):e._e(),e.send_buffer.length>0?a("v-btn",{on:{click:e.write_next_in_buffer_to_serial}},[e._v(" Unclog Stuck Buffer ")]):e._e(),e.send_buffer.length>0?a("v-btn",{on:{click:e.clear_buffer}},[e._v(" Clear Buffer ")]):e._e()],1)],1),a("v-expansion-panel",[a("v-expansion-panel-header",[e._v(" SCARA Sim ")]),a("v-expansion-panel-content",[a("ScaraSim3D",{attrs:{uploaded_gcode:this.raw_gcode,x_offset:e.scara_conv.x_offset,y_offset:e.scara_conv.y_offset}})],1)],1)],1)],1)},T=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"notSupported"}},[e._v(" Sorry, "),a("b",[e._v("Web Serial")]),e._v(" is not supported on this device, make sure you're running Chrome 78 or later and have enabled the "),a("code",[e._v("#enable-experimental-web-platform-features")]),e._v(" flag in "),a("code",[e._v("chrome://flags")])])}],E=(a("99af"),a("caad"),a("a15b"),a("0d03"),a("b680"),a("d3b7"),a("acd8"),a("ac1f"),a("2532"),a("5319"),a("1276"),a("ddb0"),a("96cf"),a("a4d3"),a("cb29"),a("4de4"),a("4160"),a("d81d"),a("13d5"),a("4057"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("3835")),R=a("ade3"),L=a("d4ec"),X=a("bee2");function Y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function P(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(a),!0).forEach((function(t){Object(R["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var A=a("d74a"),Z={L1:120,L2:120,a1_driver_teeth:20,a1_receiver_teeth:80,a1_steps_per_rev:800,a2_driver_teeth:20,a2_receiver_teeth:80,a2_secondary_receiver_teeth:80,a2_steps_per_rev:800,max_speed:4e3},F=function(){function e(t){Object(L["a"])(this,e),this.x_offset=0,this.y_offset=0,this.inner_rad=30,this.skew=0,this.feed_rate=2e3,this.right_handed=!1,this.max_seg_length=.5,this.scara_props=Z,this.error_reporter=t||function(e){alert&&alert(e)}}return Object(X["a"])(e,[{key:"parse_gcode_move",value:function(e){var t={X:void 0,Y:void 0,Z:void 0,F:void 0,E:void 0};for(var a in e){var n=e[a];"X"===n[0]&&(t.X=n[1]),"Y"===n[0]&&(t.Y=n[1]),"Z"===n[0]&&(t.Z=n[1]),"E"===n[0]&&(t.E=n[1]),"F"===n[0]&&(t.F=n[1])}return t}},{key:"scara_distance",value:function(e,t){return Math.sqrt(Math.pow(t.a1-e.a1,2)+Math.pow(t.a2-e.a2,2)+Math.pow(t.Z-e.Z,2))}},{key:"map_cartesian_to_scara",value:function(e){var t=Math.hypot(e.X,e.Y),a=Math.atan2(e.Y,e.X),n=this.right_handed?-1:1,r={a1:0,a2:0,Z:0,E:0};if(r.a1=180*(a+n*Math.acos((Math.pow(t,2)+Math.pow(this.scara_props.L1,2)-Math.pow(this.scara_props.L2,2))/(2*this.scara_props.L1*t)))/Math.PI,r.a2=180*(a-n*Math.acos((Math.pow(t,2)+Math.pow(this.scara_props.L2,2)-Math.pow(this.scara_props.L1,2))/(2*this.scara_props.L2*t)))/Math.PI,isNaN(r.a1)||isNaN(r.a2))throw console.log("ERROR: Conversion failed: GCODE results in NaNs!",e,r),this.error_reporter("ERROR: Conversion failed: GCODE results in NaNs!"),"ERROR: Conversion failed: GCODE results in NaNs!";if(r.a1>180||r.a1<0||r.a2>140||r.a2<-140)throw console.log("ERROR: Conversion failed: GCODE falls outside useable work area!",e,r),this.error_reporter("ERROR: Conversion failed: GCODE falls outside useable work area!"),"ERROR: Conversion failed: GCODE falls outside useable work area!";return r.a1=parseFloat(r.a1.toFixed(2)),r.a2=parseFloat(r.a2.toFixed(2)),r.Z=e.Z,r.E=e.E,r}},{key:"cartesian_to_scara_feedrate",value:function(e,t,a){var n=this.scara_props.L1,r=this.scara_props.L2,o=this.right_handed?-1:1,i=Math.sqrt(Math.pow(t.X-e.X,2)+Math.pow(t.Y-e.Y,2));if(0===i)return 0;var s=(t.X-e.X)/i*a,c=(t.Y-e.Y)/i*a,l=Math.sqrt(Math.pow(e.X,2)+Math.pow(e.Y,2)),d=(e.X*s+e.Y*c)/Math.sqrt(Math.pow(e.X,2)+Math.pow(e.Y,2)),u=(e.X*c-e.Y*s)/Math.pow(l,2),h=u-o*d*(2*Math.pow(l,2)*n-Math.pow(l,2)-Math.pow(n,2)+Math.pow(r,2))/(2*Math.pow(l,2)*Math.pow(n,2))*Math.sqrt(1-(Math.pow(l,2)+Math.pow(n,2)-Math.pow(r,2))/(2*l*n)),p=u+o*d*(2*Math.pow(l,2)*r-Math.pow(l,2)-Math.pow(r,2)+Math.pow(n,2))/(2*Math.pow(l,2)*Math.pow(r,2))*Math.sqrt(1-(Math.pow(l,2)+Math.pow(r,2)-Math.pow(n,2))/(2*l*r)),f=Math.sqrt(Math.pow(h,2)+Math.pow(p,2));return parseFloat(Math.min(Math.abs(180*Math.round(f)/Math.PI),this.scara_props.max_speed).toFixed(1))}},{key:"interpolate",value:function(e,t,a,n){return{X:(a*t.X+(n-a)*e.X)/n,Y:(a*t.Y+(n-a)*e.Y)/n,Z:(a*t.Z+(n-a)*e.Z)/n,E:(a*t.E+(n-a)*e.E)/n,F:this.feed_rate}}},{key:"segmentize_cartesian_to_scara",value:function(e,t){var a=this,n=this.scara_distance(this.map_cartesian_to_scara(e),this.map_cartesian_to_scara(t));if(n<=this.max_seg_length)return[this.map_cartesian_to_scara(t)];var r=Math.round(Math.ceil(n/this.max_seg_length));return Array(r).fill(0).map((function(n,o){return a.map_cartesian_to_scara(a.interpolate(e,t,o+1,r))}))}},{key:"translate",value:function(e){var t=P({},e),a=(Math.hypot(e.X,e.Y),Math.atan2(e.Y,e.X));this.skew;return t.X=e.X+this.x_offset,t.Y=e.Y+this.y_offset,t}},{key:"plot_scara_move",value:function(e,t){var a=[],n=A.parseLine(e);if(0===n.words.length)return[[],t];if("G"===n.words[0][0]&&[0,1].includes(n.words[0][1])||!["G","M"].includes(n.words[0][0])){var r=!1;"G"===n.words[0][0]&&0===n.words[0][1]&&(r=!0);var o=this.parse_gcode_move(n.words);if(o.Y=o.Y+this.inner_rad,isNaN(o.X)&&(o.X=t.X),isNaN(o.Y)&&(o.Y=t.Y),isNaN(o.Z)&&(o.Z=t.Z),isNaN(o.E)&&(o.E=t.E),isNaN(o.F)&&(o.F=t.F),o.X===t.X&&o.Y===t.Y)return o.Z!==t.Z&&a.push("G1 Z".concat(o.Z," F").concat(this.feed_rate)),[a,o];if(void 0===t.X&&void 0===t.Y||r){var i=this.map_cartesian_to_scara(this.translate(o));return a.push("G0 X".concat(i.a1," Y").concat(i.a2," Z").concat(i.Z," F").concat(this.feed_rate)),[a,o]}var s=Math.sqrt(Math.pow(o.X-t.X,2)+Math.pow(o.Y-t.Y,2)),c={X:t.X,Y:t.Y,Z:t.Z};while(s>this.max_seg_length){c={X:c.X+(o.X-c.X)*this.max_seg_length/s,Y:c.Y+(o.Y-c.Y)*this.max_seg_length/s,Z:c.Z+(o.Z-c.Z)*this.max_seg_length/s};var l=this.map_cartesian_to_scara(this.translate(c)),d=this.cartesian_to_scara_feedrate(c,o,this.feed_rate);a.push("G1 X".concat(l.a1," Y").concat(l.a2," Z").concat(l.Z," F").concat(d)),s=Math.sqrt(Math.pow(o.X-c.X,2)+Math.pow(o.Y-c.Y,2))}var u=this.map_cartesian_to_scara(this.translate(c)),h=this.cartesian_to_scara_feedrate(c,o,this.feed_rate);return a.push("G1 X".concat(u.a1," Y").concat(u.a2," Z").concat(u.Z," F").concat(h)),[a,o]}return"G"===n.words[0][0]&&92.1===n.words[0][1]?[[],{X:0,Y:0,Z:0,E:0,F:this.feed_rate}]:[["(unable to parse line: ".concat(e,")")],t]}},{key:"convert_cartesian_to_scara",value:function(e){var t=this;e=e.replace(/[N]\d+(?= [^G])/g,"G1"),e=e.replace(/[N]\d+ /g,"");var a=e.split("\n"),n={X:void 0,Y:void 0,Z:0,F:this.feed_rate},r=("M92 X".concat(this.scara_props.a1_steps_per_rev/360*(this.scara_props.a1_receiver_teeth/this.scara_props.a1_driver_teeth)),"M92 Y".concat(this.scara_props.a2_steps_per_rev/360*(this.scara_props.a2_receiver_teeth/this.scara_props.a2_driver_teeth)*(this.scara_props.a2_secondary_receiver_teeth/this.scara_props.a2_receiver_teeth)),a.reduce((function(e,a){var r=[],o=t.plot_scara_move(a,n),i=Object(E["a"])(o,2);return r=i[0],n=i[1],e.concat(r)}),[]));return r.join("\n")}}]),e}(),D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-scene",{staticStyle:{width:"600px",height:"400px",margin:"auto"},attrs:{embedded:"","vr-mode-ui":"enabled: false"}},[a("a-entity",[a("a-cylinder",{attrs:{position:"0 140 -44",radius:"8",height:"280",color:"#444444"}}),a("a-cylinder",{attrs:{position:"0 100 0",radius:"12",height:"200",color:"#CCCCCC",metalness:"0.5"}}),a("a-cylinder",{attrs:{position:"42 100 -60",radius:"12",height:"200",color:"#CCCCCC",metalness:"0.5"}}),a("a-cylinder",{attrs:{position:"-42 100 -60",radius:"12",height:"200",color:"#CCCCCC",metalness:"0.5"}})],1),a("a-entity",{attrs:{position:"0 "+e.z+" 0"}},[a("a-box",{attrs:{height:"5",width:"130",depth:"140",position:"0 0 -30"}}),a("a-entity",{attrs:{rotation:"0 "+e.a1+" 0",position:"0 10 0"}},[a("a-box",{attrs:{height:"10",width:"50",depth:"140",position:"0 0 70"}}),a("a-cylinder",{attrs:{position:"0 0 0",radius:"25",height:"10"}}),a("a-cylinder",{attrs:{position:"0 0 140",radius:"25",height:"10"}}),a("a-entity",{attrs:{rotation:"0 "+e.a2+" 0",position:"0 10 140"}},[a("a-box",{attrs:{height:"10",width:"50",depth:"140",position:"0 0 70"}}),a("a-cylinder",{attrs:{position:"0 0 0",radius:"25",height:"10"}}),a("a-cylinder",{attrs:{position:"0 0 140",radius:"25",height:"10"}}),a("a-cylinder",{attrs:{position:"0 -80 140",radius:"5",height:"160",color:"black"}})],1)],1)],1),a("a-entity",{attrs:{meshline:"lineWidth: 5; path: "+e.path_str+"; color: #E20049",position:e.x_offset+" 20 "+e.y_offset}}),a("a-plane",{attrs:{position:"0 0 0",rotation:"-90 0 0",width:"400",height:"400",color:"#7BC8A4"}}),a("a-sky",{attrs:{color:"#ECECEC"}}),a("a-entity",{attrs:{camera:"","look-controls":"","orbit-controls":"target: 0 0 0; minDistance: 200; maxDistance: 600; initialPosition: 200 200 200"}})],1),a("br"),a("br"),a("v-slider",{attrs:{label:"Near Arm Angle","thumb-color":"red","thumb-label":"always",min:"-90",max:"90"},model:{value:e.a1,callback:function(t){e.a1=t},expression:"a1"}}),a("v-slider",{attrs:{label:"Far Arm Angle‏‏‎ ‎‎","thumb-color":"red","thumb-label":"always",min:"-90",max:"90"},model:{value:e.a2,callback:function(t){e.a2=t},expression:"a2"}})],1)},N=[],V=(a("fb6a"),a("a9e3"),a("d74a")),z=n["default"].extend({props:{x_offset:Number,y_offset:Number,uploaded_gcode:String},data:function(){return{z:180,a1:0,a2:0,a1_start_angle:0,a2_start_angle:0,a1_len:140,a2_len:140,path:[]}},methods:{gen_path:function(e){e=e.replace(/[N]\d+(?= [^G])/g,"G1"),e=e.replace(/[N]\d+ /g,"");var t=[0,0,0],a=e.split("\n").reduce((function(e,a){var n=V.parseLine(a);if(0===n.words.length)return e;var r=t.slice();for(var o in n.words){var i=n.words[o];"X"===i[0]&&(r[0]=i[1]),"Y"===i[0]&&(r[2]=i[1]),"Z"===i[0]&&(r[1]=i[1])}return t=r,e.push(r),e}),[]);this.path=a}},watch:{uploaded_gcode:function(){this.gen_path(this.uploaded_gcode)}},computed:{path_str:function(){return this.path.reduce((function(e,t){return"".concat(e).concat(""!=e?",":""," ").concat(t[0]," ").concat(t[1]," ").concat(t[2])}),"")},x2:function(){var e=Math.cos((this.a1+this.a1_start_angle)*Math.PI/180)*this.a1_len,t=e+Math.cos((this.a2+this.a2_start_angle)*Math.PI/180)*this.a2_len;return t},y2:function(){var e=Math.sin((this.a1+this.a1_start_angle)*Math.PI/180)*this.a1_len,t=e+Math.sin((this.a2+this.a2_start_angle)*Math.PI/180)*this.a2_len;return t}},mounted:function(){var e=this;this.$nextTick((function(){e.gen_path(e.uploaded_gcode)}))}}),I=z,$=a("ba0d"),B=Object(d["a"])(I,D,N,!1,null,null,null),U=B.exports;h()(B,{VSlider:$["a"]});var q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{width:"300px","max-width":"100%"}},[a("v-text-field",{attrs:{label:"Custom Text"},model:{value:e.userText,callback:function(t){e.userText=t},expression:"userText"}}),a("v-text-field",{attrs:{type:"number",label:"Font Size"},model:{value:e.fontSize,callback:function(t){e.fontSize=e._n(t)},expression:"fontSize"}}),a("v-select",{attrs:{items:e.fontOptions,"item-text":"name","item-value":"file"},model:{value:e.fontName,callback:function(t){e.fontName=t},expression:"fontName"}})],1),a("br"),a("canvas",{staticStyle:{border:"1px solid black"},attrs:{id:"canvas",width:240*e.svgScaler,height:120*e.svgScaler}})])},H=[],W=(a("a434"),a("a788")),J=a("dbcd"),K=a.n(J),Q=a("84fa"),ee=a.n(Q),te=n["default"].extend({data:function(){return{userText:"Jordan Poles",fontName:"GreatVibes-Regular.ttf",fontSize:40,userInputDebounce:0,svgScaler:2,fontOptions:[{name:"GreatVibes (caligraphy)",file:"GreatVibes-Regular.ttf"},{name:"ChunkFive (block)",file:"ChunkFive-Regular.otf"}]}},watch:{userText:function(){var e=this;clearTimeout(this.userInputDebounce),this.userInputDebounce=setTimeout((function(){return e.textToGcode()}),500)},fontName:function(){var e=this;clearTimeout(this.userInputDebounce),this.userInputDebounce=setTimeout((function(){return e.textToGcode()}),250)},fontSize:function(){var e=this;clearTimeout(this.userInputDebounce),this.userInputDebounce=setTimeout((function(){return e.textToGcode()}),500)}},methods:{textToGcode:function(){var e=this;W["a"].load("fonts/".concat(this.fontName),(function(t,a){if(t)alert("Font could not be loaded: "+t);else{var n=a.getPath(e.userText,10,e.fontSize+10,e.fontSize).toPathData(2),r=n.split("Z"),o=10,i="G1Z".concat(o),s="";r.forEach((function(t){var a=ee()(t).unarc().abs(),n=[],r=[],c=[void 0,void 0],l=function(t,a,o,i,s){0==n.length&&(c=[o,i]),n.push("G1X".concat(o,"Y").concat(i)),r.push("".concat(r.length>0?"L":"M"," ").concat(o*e.svgScaler," ").concat(i*e.svgScaler))},d=new K.a(l);a.iterate(d.svgPathIterator),n.splice(1,0,"G1Z0"),void 0!=c[0]&&void 0!=c[1]&&n.push("G1X".concat(c[0],"Y").concat(c[1])),n.push("G1Z".concat(o)),i=i+"\n"+n.join("\n"),r.push("Z"),s=s+" "+r.join(" ")})),e.$emit("gcodegen",i);var c=document.getElementById("canvas"),l=c.getContext("2d");l.clearRect(0,0,c.offsetWidth,c.offsetHeight);var d=new Path2D(s);l.stroke(d)}}))}},mounted:function(){var e=this;this.$nextTick((function(){e.textToGcode()}))}}),ae=te,ne=a("b974"),re=a("8654"),oe=Object(d["a"])(ae,q,H,!1,null,null,null),ie=oe.exports;h()(oe,{VSelect:ne["a"],VTextField:re["a"]});var se=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{width:"300px","max-width":"100%"}},[a("v-file-input",{attrs:{placeholder:"Upload Image",accept:".svg,.png,.jpg,.jpeg"},on:{change:e.load_img_file}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.imageSize[0]+e.imageSize[1]>0,expression:"imageSize[0] + imageSize[1] > 0"}]},[a("div",{staticStyle:{display:"flex"}},[a("canvas",{staticStyle:{border:"1px solid black"},attrs:{id:"svg-canvas",width:"0",height:"0"}}),a("div",{staticStyle:{width:"300px","margin-left":"20px",border:"1px #888 solid","background-color":"lightblue",padding:"16px","border-radius":"10px"}},[a("br"),a("v-slider",{attrs:{"thumb-label":"always",min:"0",max:"200",label:"GCode Scaler %"},on:{change:e.svgToGcode},model:{value:e.gcodeScale,callback:function(t){e.gcodeScale=t},expression:"gcodeScale"}}),"photo"==e.imageType?a("div",[a("br"),a("v-slider",{attrs:{"thumb-label":"always",min:"-1",max:"255",label:"Threshold"},on:{change:e.photoToSVG},scopedSlots:e._u([{key:"append",fn:function(){return[a("v-icon",{directives:[{name:"ripple",rawName:"v-ripple"},{name:"show",rawName:"v-show",value:-1!=e.potraceParams.threshold,expression:"potraceParams.threshold != -1"}],on:{click:function(t){e.potraceParams.threshold=-1}}},[e._v(" mdi-replay ")])]},proxy:!0}],null,!1,3891612062),model:{value:e.potraceParams.threshold,callback:function(t){e.$set(e.potraceParams,"threshold",t)},expression:"potraceParams.threshold"}}),a("br"),a("v-slider",{attrs:{"thumb-label":"always",min:"0",max:"50",label:"Min Speckle Size"},on:{change:e.photoToSVG},model:{value:e.potraceParams.turdSize,callback:function(t){e.$set(e.potraceParams,"turdSize",t)},expression:"potraceParams.turdSize"}}),a("br"),a("v-checkbox",{attrs:{label:"Invert"},on:{change:e.photoToSVG},model:{value:e.potraceParams.blackOnWhite,callback:function(t){e.$set(e.potraceParams,"blackOnWhite",t)},expression:"potraceParams.blackOnWhite"}})],1):e._e()],1)]),e._v(" Print Size: "+e._s((e.imageSize[0]*e.gcodeScale/100).toFixed(1))+" x "+e._s((e.imageSize[1]*e.gcodeScale/100).toFixed(1))+" mm ")])])},ce=[],le=(a("a630"),a("3ca3"),Math.PI),de=2*le,ue={approximationScale:1,curve_distance_epsilon:1e-30,curveColinearityEpsilon:1e-30,curveAngleToleranceEpsilon:.01,angleTolerance:.4,recursionLimit:32,cuspLimit:0},he=function(){function e(t,a){var n=this;Object(L["a"])(this,e),this.svgPathIterator=function(e,t,a,r){var o,i,s,c,l,d,u,h,p,f=e[0],_=!1;switch(f){case"M":for(o=1;o<e.length;o+=2)i=e[o],s=e[o+1],n.consumer(a,r,i,s,t,["M",i,s]),a=i,r=s;break;case"L":for(o=1;o<e.length;o+=2)i=e[o],s=e[o+1],n.consumer(a,r,i,s,t,["L",i,s]),a=i,r=s;break;case"H":for(s=r,o=1;o<e.length;o+=2)i=e[o],n.consumer(a,r,i,s,t,["H",i]),a=i;break;case"V":for(i=a,o=1;o<e.length;o+=2)s=e[o],n.consumer(a,r,i,s,t,["V",s]),r=s;break;case"Z":n.consumer(a,r,a,r,t,["Z"]);break;case"Q":_=!0;case"C":var v=_?4:6;for(o=1;o<e.length;o+=v)i=a,s=r,c=e[o],l=e[o+1],d=_?c:e[o+2],u=_?l:e[o+3],h=_?e[o+2]:e[o+4],p=_?e[o+3]:e[o+5],n.linearize(i,s,c,l,d,u,h,p,t),a=i,r=s;break;default:throw new Error("path command '"+f+"' not supported yet")}},this.consumer=function(e,a,r,o,i,s){t(e,a,r,o,i,s),n.prevX=r,n.prevY=o},this.opts=Object.assign({},ue,a),this.prevX=0,this.prevY=0}return Object(X["a"])(e,[{key:"linearize",value:function(e,t,a,n,r,o,i,s,c){this.linearizeRecursive(e,t,a,n,r,o,i,s,c,0);var l=this.prevX,d=this.prevY;l===i&&d===s||this.consumer(l,d,i,s,c,["L",i,s])}},{key:"distanceTo",value:function(e,t,a,n){var r=a-e,o=n-t;return Math.sqrt(r*r+o*o)}},{key:"linearizeRecursive",value:function(e,t,a,n,r,o,i,s,c,l){var d,u,h,p=this.opts.cuspLimit,f=this.opts.curveColinearityEpsilon,_=this.opts.curveAngleToleranceEpsilon,v=this.opts.angleTolerance,g=Math.pow(.5/this.opts.approximationScale,2),m=(e+a)/2,b=(t+n)/2,w=(a+r)/2,x=(n+o)/2,y=(r+i)/2,k=(o+s)/2,S=(m+w)/2,M=(b+x)/2,C=(w+y)/2,O=(x+k)/2,G=(S+C)/2,j=(M+O)/2,T=i-e,E=s-t,R=Math.abs((a-i)*E-(n-s)*T),L=Math.abs((r-i)*E-(o-s)*T);switch((R>f?2:0)+(L>f?1:0)){case 0:if(h=T*T+E*E,0===h)R=this.distanceTo(e,t,a,n),L=this.distanceTo(i,s,r,o);else{if(h=1/h,d=a-e,u=n-t,R=h*(d*T+u*E),d=r-e,u=o-t,L=h*(d*T+u*E),R>0&&R<1&&L>0&&L<1)return void this.consumer(e,t,i,s,c,["L",i,s]);R=R<=0?this.distanceTo(a,n,e,t):R>=1?this.distanceTo(a,n,i,s):this.distanceTo(a,n,e+R*T,t+R*E),L=L<=0?this.distanceTo(r,o,e,t):L>=1?this.distanceTo(r,o,i,s):this.distanceTo(r,o,e+L*T,t+L*E)}if(R>L){if(R<g)return void this.consumer(e,t,a,n,c,["L",a,n])}else if(L<g)return void this.consumer(e,t,r,o,c,["L",r,o]);break;case 1:if(L*L<=g*(T*T+E*E)){if(v<_)return void this.consumer(e,t,w,x,c,["L",w,x]);if(d=Math.abs(Math.atan2(s-o,i-r)-Math.atan2(o-n,r-a)),d>=le&&(d=de-d),d<v)return this.consumer(e,t,a,n,c,["L",a,n]),void this.consumer(a,n,r,o,c,["L",r,o]);if(0!==p&&d>le-p)return void this.consumer(e,t,r,o,c,["L",r,o])}break;case 2:if(R*R<=g*(T*T+E*E)){if(v<_)return void this.consumer(e,t,w,x,c,["L",w,x]);if(d=Math.abs(Math.atan2(o-n,r-a)-Math.atan2(n-t,a-e)),d>=le&&(d=de-d),d<v)return this.consumer(e,t,a,n,c,["L",a,n]),void this.consumer(a,n,r,o,c,["L",r,o]);if(0!==p&&d>le-p)return void this.consumer(e,t,a,n,c,["L",a,n])}break;case 3:if((R+L)*(R+L)<=g*(T*T+E*E)){if(v<_)return void this.consumer(e,t,w,x,c,["L",w,x]);if(h=Math.atan2(o-n,r-a),d=Math.abs(h-Math.atan2(n-t,a-e)),u=Math.abs(Math.atan2(s-o,i-r)-h),d>=le&&(d=de-d),u>=le&&(u=de-u),d+u<v)return void this.consumer(e,t,w,x,c,["L",w,x]);if(0!==p){if(d>le-p)return void this.consumer(e,t,a,n,c,["L",a,n]);if(u>le-p)return void this.consumer(e,t,r,o,c,["L",r,o])}}break}var X=l+1;X>=this.opts.recursionLimit?this.consumer(e,t,i,s,c,["L",i,s]):(this.linearizeRecursive(e,t,m,b,S,M,G,j,c,X),this.linearizeRecursive(G,j,C,O,y,k,i,s,c,X))}}]),e}(),pe=a("cd7e"),fe=a.n(pe),_e=a("f46b"),ve=n["default"].extend({data:function(){return{imageSize:[0,0],rawPhoto:void 0,rawSVG:"",imageType:"",gcodeScale:25,potraceParams:{threshold:-1,turdSize:15,blackOnWhite:!0},finalGcode:""}},methods:{load_img_file:function(e){var t=this;if(null!==e){var a=new FileReader;["image/jpeg","image/jpg","image/png"].includes(e.type)?(a.onload=function(e){t.imageType="photo",t.rawPhoto=a.result,t.photoToSVG()},Object(_e["a"])().toBlob(e,{max:400}).then((function(e){return a.readAsArrayBuffer(e)}))):"image/svg+xml"==e.type?(a.onload=function(e){t.rawSVG=a.result,t.svgToGcode()},a.readAsText(e)):this.imageType=""}},photoToSVG:function(){var e=this;void 0!=this.rawPhoto&&fe.a.trace(this.rawPhoto,this.potraceParams,(function(t,a){if(t)throw t;e.rawSVG=a,e.svgToGcode()}))},svgToGcode:function(){var e=this,t=(new DOMParser).parseFromString(this.rawSVG,"image/svg+xml"),a=Array.from(t.querySelectorAll("path").values()).reduce((function(e,t){var a=t.getAttribute("d");return e.push(a),e}),[]),n=5,r="",o="",i=[0,0],s=[0,0];a.forEach((function(t){var a=ee()(t).unarc().abs(),c=[],l=[],d=function(t,a,r,o,d,u){r>i[0]&&(i[0]=r),o>i[1]&&(i[1]=o),r=r*e.gcodeScale/100,o=o*e.gcodeScale/100,"M"==u[0]?(c.push(["G0","Z".concat(n)]),c.push(["G0","X".concat(r),"Y".concat(o)]),c.push(["G0","Z0"]),s=[r,o]):"Z"==u[0]?c.push(["G0","X".concat(s[0]),"Y".concat(s[1])]):c.push(["G1","X".concat(r),"Y".concat(o)]),l.push(u.join(" "))},u=new he(d,{recursionLimit:4,curve_distance_epsilon:1e-5,curveColinearityEpsilon:1e-5});a.iterate(u.svgPathIterator),r=r+"\n"+c.map((function(e){return e.join("")})).join("\n"),o=o+" "+l.join(" ")}));var c=document.getElementById("svg-canvas");this.imageSize=i,c.setAttribute("width","".concat(i[0])),c.setAttribute("height","".concat(i[1]));var l=c.getContext("2d");l.clearRect(0,0,c.offsetWidth,c.offsetHeight);var d=new Path2D(o);l.stroke(d),this.$emit("gcodegen",r)}}}),ge=ve,me=a("ac7c"),be=a("23a7"),we=a("269a"),xe=a.n(we),ye=a("5607"),ke=Object(d["a"])(ge,se,ce,!1,null,null,null),Se=ke.exports;h()(ke,{VCheckbox:me["a"],VFileInput:be["a"],VIcon:f["a"],VSlider:$["a"]}),xe()(ke,{Ripple:ye["a"]});var Me=a("9e3e"),Ce=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Oe=n["default"].extend({components:{ScaraSim3D:U,TextToGcode:ie,ImgToGcode:Se},data:function(){var e=this;return{raw_gcode:"",send_buffer:[],last_resp:void 0,send_buffer_interval:void 0,converted_gcode:[],scara_conv:new F((function(t){e.$toast(t,{x:"center",color:"red"})})),send_log:[],send_log_index:0,recv_buffer:"",serial_log:[],cmd:"",jog_inc:{x:10,y:10,z:10},goto:{x:0,y:0},attempting_to_connect:!1,cancel_connect:!1,reader:void 0,output_stream:void 0,regen_debounce:0}},watch:{"scara_conv.x_offset":function(){clearTimeout(this.regen_debounce),this.regen_debounce=setTimeout(this.regen_converted_gcode,500)},"scara_conv.y_offset":function(){clearTimeout(this.regen_debounce),this.regen_debounce=setTimeout(this.regen_converted_gcode,500)}},methods:{goto_point:function(){var e,t;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return e="G1 X".concat(this.goto.x," Y").concat(this.goto.y," F50000\n"),t=this.scara_conv.convert_cartesian_to_scara(e),a.next=4,regeneratorRuntime.awrap(this.write_serial(t+"\n"));case 4:case"end":return a.stop()}}),null,this)},home_scara:function(){var e,t,a;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:e=["G1 Z10 F5000","G1 X0 Y0 F5000","G1 Z0 F5000"],n.t0=regeneratorRuntime.keys(e);case 2:if((n.t1=n.t0()).done){n.next=9;break}return t=n.t1.value,a=e[t],n.next=7,regeneratorRuntime.awrap(this.write_serial(a+"\n"));case 7:n.next=2;break;case 9:case"end":return n.stop()}}),null,this)},recover_prev_cmd:function(e){this.cmd==this.send_log[this.send_log_index]?(this.send_log_index+=e,this.send_log_index<this.send_log.length&&(this.cmd=this.send_log[this.send_log_index])):this.send_log.length>0&&(this.send_log_index=0,this.cmd=this.send_log[this.send_log_index])},read_serial:function(){var e,t,a;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(void 0!==this.reader){n.next=2;break}return n.abrupt("return");case 2:return n.next=5,regeneratorRuntime.awrap(this.reader.read());case 5:if(e=n.sent,t=e.value,a=e.done,t&&(this.recv_buffer+=t,this.recv_buffer.includes("\n")&&(this.send_buffer.length>0&&(this.recv_buffer.includes("ok")||this.recv_buffer.includes("error:"))&&(this.last_resp=Date.now(),this.write_next_in_buffer_to_serial()),this.recv_buffer=this.recv_buffer.replace("\n","<br>"),this.serial_log.push(this.recv_buffer),this.recv_buffer="")),!a){n.next=12;break}return this.reader.releaseLock(),n.abrupt("break",14);case 12:n.next=2;break;case 14:case"end":return n.stop()}}),null,this)},write_next_in_buffer_to_serial:function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:this.write_serial(this.send_buffer.shift()+"\n");case 1:case"end":return e.stop()}}),null,this)},write_cmd_to_serial:function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.write_serial(this.cmd+"\n"));case 2:this.send_log.unshift(this.cmd),this.cmd="";case 4:case"end":return e.stop()}}),null,this)},write_serial:function(e){var t;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(void 0!==this.output_stream){a.next=3;break}return this.$toast("Failed to write to serial"),a.abrupt("return");case 3:return t=this.output_stream.getWriter(),a.next=6,regeneratorRuntime.awrap(t.write(e));case 6:return a.next=8,regeneratorRuntime.awrap(t.releaseLock());case 8:case"end":return a.stop()}}),null,this)},serial_connect:function(){var e,t,a,n,r,o=this;return regeneratorRuntime.async((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,regeneratorRuntime.awrap(navigator.serial.requestPort());case 2:e=i.sent,t="",this.attempting_to_connect=!0;case 5:if(void 0==t){i.next=18;break}return t=void 0,i.next=9,regeneratorRuntime.awrap(e.open({baudRate:25e4}).catch((function(e){o.$toast("Failed to open serial connection: ".concat(e)),t=e})));case 9:if(!this.cancel_connect){i.next=13;break}return this.cancel_connect=!1,this.attempting_to_connect=!1,i.abrupt("return");case 13:if(void 0==t){i.next=16;break}return i.next=16,regeneratorRuntime.awrap(Ce(1500));case 16:i.next=5;break;case 18:this.attempting_to_connect=!1,a=new TextEncoderStream,a.readable.pipeTo(e.writable),this.output_stream=a.writable,this.send_buffer_interval=setInterval((function(){o.send_buffer.length>0&&(Date.now()-(o.last_resp||0))/1e3>2&&o.write_serial("?\n")}),4e3),n=new TextDecoderStream,e.readable.pipeTo(n.writable),r=n.readable,this.reader=r.getReader(),this.read_serial();case 28:case"end":return i.stop()}}),null,this)},regen_converted_gcode:function(){this.converted_gcode=this.scara_conv.convert_cartesian_to_scara(this.raw_gcode).split("\n")},load_gcode_file:function(e){var t=this;if(null!==e){var a=new FileReader;a.onload=function(e){t.raw_gcode=e.target.result,t.regen_converted_gcode()},a.readAsText(e)}},gcode_from_text:function(e){this.raw_gcode=e+["G0Z10","G0X".concat(this.scara_conv.scara_props.L1+this.scara_conv.scara_props.L2,"Y-").concat(this.scara_conv.inner_rad),"G0Z0"].join("\n"),this.regen_converted_gcode()},saveGcode:function(e){Object(Me["a"])(new Blob([e],{type:"text/plain"}),"jscara_export.gcode")},clear_buffer:function(){this.send_buffer=[]},send_converted_gcode:function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:this.send_buffer=this.send_buffer.concat(this.converted_gcode),this.write_next_in_buffer_to_serial();case 2:case"end":return e.stop()}}),null,this)}},computed:{work_area_dim:function(){var e=this.scara_conv.inner_rad,t=this.scara_conv.scara_props.L1+this.scara_conv.scara_props.L2;return parseFloat(((-e+Math.sqrt(2*Math.pow(t,2)-Math.pow(e,2)))/2).toFixed(0))}},mounted:function(){if(void 0!==navigator.serial){var e=document.getElementById("notSupported");e.style.display="none"}}}),Ge=Oe,je=(a("cccb"),a("cd55")),Te=a("49e2"),Ee=a("c865"),Re=a("0393"),Le=a("0fd9"),Xe=Object(d["a"])(Ge,j,T,!1,null,null,null),Ye=Xe.exports;h()(Xe,{VBtn:p["a"],VExpansionPanel:je["a"],VExpansionPanelContent:Te["a"],VExpansionPanelHeader:Ee["a"],VExpansionPanels:Re["a"],VFileInput:be["a"],VRow:Le["a"],VTextField:re["a"]});var Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"scara-converter"}},[a("v-file-input",{on:{change:e.load_gcode_file}})],1)},Ae=[],Ze=(a("b0c0"),n["default"].extend({data:function(){return{scara:new F}},methods:{download_gcode:function(e,t){var a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)},load_gcode_file:function(e){var t=this,a=new FileReader;a.onload=function(a){t.download_gcode("".concat(e.name.replace(".gcode","").replace(".nc",""),"_converted.gcode"),t.scara.convert_cartesian_to_scara(a.target.result))},a.readAsText(e)}},mounted:function(){}})),Fe=Ze,De=(a("b396"),Object(d["a"])(Fe,Pe,Ae,!1,null,"56b51dc2",null)),Ne=De.exports;h()(De,{VFileInput:be["a"]});var Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-slider",{staticStyle:{padding:"10px 24px"},attrs:{min:"-80",max:"80","thumb-label":"",label:"Arm 1 Angle:"},on:{input:e.plotScara},model:{value:e.a1,callback:function(t){e.a1=t},expression:"a1"}}),a("v-slider",{staticStyle:{padding:"10px 24px"},attrs:{min:"-80",max:"80","thumb-label":"",label:"Arm 2 Angle:"},on:{input:e.plotScara},model:{value:e.a2,callback:function(t){e.a2=t},expression:"a2"}}),a("div",{staticStyle:{border:"1px dotted #222"}},[a("svg",{attrs:{width:e.width,height:e.height}})])],1)},ze=[],Ie=Object.assign({},a("fd32"),a("f1df"),a("ce24"),a("4611"),a("bc17"),a("a1eb")),$e=n["default"].extend({data:function(){return{a1:0,a2:0,width:500,height:500,padding:{top:30,right:30,bottom:60,left:60},plot_area:{width:400,height:400}}},methods:{plotScara:function(){var e=Ie.select(this.$el).select("svg");if(e.selectAll("*").remove(),void 0!==e){var t=e.append("g");t.attr("width",this.width-this.padding.left-this.padding.right).attr("height",this.height-this.padding.top-this.padding.bottom).attr("transform","translate("+this.padding.left+","+this.padding.top+")").attr("class","davenport-plot-area");var a=Ie.scaleLinear().domain([0,this.plot_area.width]).range([0,this.width-this.padding.left-this.padding.right]);t.append("g").attr("transform","translate(0,"+(this.height-this.padding.bottom-10)+")").call(Ie.axisBottom(a));var n=Ie.scaleLinear().domain([0,this.plot_area.height]).range([this.height-this.padding.top-this.padding.bottom,0]);t.append("g").call(Ie.axisLeft().scale(n));var r=90,o=90,i=this.plot_area.width/2+Math.cos((this.a1+r)*Math.PI/180)*Z.L1,s=Math.sin((this.a1+r)*Math.PI/180)*Z.L1;t.append("line").attr("x1",a(this.plot_area.width/2)).attr("x2",a(i)).attr("y1",n(0)).attr("y2",n(s)).attr("stroke","coral").attr("stroke-width",20).attr("stroke-linecap","round");var c=i+Math.cos((this.a2+o)*Math.PI/180)*Z.L2,l=s+Math.sin((this.a2+o)*Math.PI/180)*Z.L2;t.append("line").attr("x1",a(i)).attr("x2",a(c)).attr("y1",n(s)).attr("y2",n(l)).attr("stroke","teal").attr("stroke-width",20).attr("stroke-linecap","round")}}},mounted:function(){var e=this;this.$nextTick((function(){e.plotScara()}))}}),Be=$e,Ue=Object(d["a"])(Be,Ve,ze,!1,null,null,null),qe=Ue.exports;h()(Ue,{VSlider:$["a"]}),n["default"].use(G["a"]);var He=[{path:"/",name:"home",component:Ye},{path:"/scara",name:"SCARA",component:Ne},{path:"/sim",name:"sim",component:qe}],We=new G["a"]({mode:"history",base:"/",routes:He}),Je=We,Ke=a("2f62");n["default"].use(Ke["a"]);var Qe=new Ke["a"].Store({state:{},mutations:{},actions:{},modules:{}}),et=a("9483");Object(et["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var tt=a("ce5b"),at=a.n(tt),nt=(a("bf40"),a("87f6")),rt=a.n(nt);n["default"].use(at.a),n["default"].use(rt.a,{showClose:!1,color:"#403e4d"});var ot={},it=new at.a(ot);n["default"].config.productionTip=!1,n["default"].config.ignoredElements=["a-scene","a-assets","a-sky","a-camera","a-cursor","a-animation","a-entity","a-box","a-cylinder","a-plane"],new n["default"]({router:Je,store:Qe,vuetify:it,render:function(e){return e(O)}}).$mount("#app")}});
//# sourceMappingURL=app.23186ddf.js.map