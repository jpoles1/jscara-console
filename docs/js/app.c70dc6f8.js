(function(t){function e(e){for(var a,i,s=e[0],c=e[1],l=e[2],d=0,h=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/jscara-console/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([1,"chunk-vendors"]),n()})({0:function(t,e){},"034f":function(t,e,n){"use strict";var a=n("8a23"),o=n.n(a);o.a},1:function(t,e,n){t.exports=n("cd49")},1888:function(t,e,n){"use strict";var a=n("9189"),o=n.n(a);o.a},2:function(t,e){},3:function(t,e){},4230:function(t,e,n){},"82ec":function(t,e,n){},"8a23":function(t,e,n){},"8c83":function(t,e,n){},9189:function(t,e,n){},"9e3e":function(t,e,n){"use strict";(function(t){n("b0c0"),n("ac1f"),n("5319");var a=n("53ca"),o="object"===("undefined"===typeof window?"undefined":Object(a["a"])(window))&&window.window===window?window:"object"===("undefined"===typeof self?"undefined":Object(a["a"])(self))&&self.self===self?self:"object"===("undefined"===typeof t?"undefined":Object(a["a"])(t))&&t.global===t?t:void 0;function r(t,e){return"undefined"===typeof e?e={autoBom:!1}:"object"!==Object(a["a"])(e)&&(e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}function i(t,e,n){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){u(a.response,e,n)},a.onerror=function(){alert("Error: could not download file!")},a.send()}function s(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(n){}return e.status>=200&&e.status<=299}function c(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var l=/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u="object"!==("undefined"===typeof window?"undefined":Object(a["a"])(window))||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(t,e,n){var a=o.URL||o.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"===typeof t?(r.href=t,r.origin!==location.origin?s(r.href)?i(t,e,n):c(r,r.target="_blank"):c(r)):(r.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(r.href)}),4e4),setTimeout((function(){c(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,n){if(e=e||t.name||"download","string"===typeof t)if(s(t))i(t,e,n);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){c(a)}))}else navigator.msSaveOrOpenBlob(r(t,n),e)}:function(t,e,n,a){if(a=a||open("","_blank"),a&&(a.document.title=a.document.body.innerText="downloading..."),"string"===typeof t)return i(t,e,n);var r="application/octet-stream"===t.type,s=/constructor/i.test(o.HTMLElement)||o.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||r&&s||l)&&"undefined"!==typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=c?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=t:location=t,a=null},u.readAsDataURL(t)}else{var d=o.URL||o.webkitURL,h=d.createObjectURL(t);a?a.location=h:location.href=h,a=null,setTimeout((function(){d.revokeObjectURL(h)}),4e4)}};e["a"]=u}).call(this,n("c8ba"))},b396:function(t,e,n){"use strict";var a=n("8c83"),o=n.n(a);o.a},cccb:function(t,e,n){"use strict";var a=n("4230"),o=n.n(a);o.a},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("Header"),n("v-content",{staticStyle:{"margin-top":"20px"}},[n("router-view")],1),n("Footer")],1)},r=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.$vuetify.breakpoint.xsOnly?n("v-navigation-drawer",{attrs:{clipped:"","mobile-break-point":"600",width:"180"},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",{attrs:{shaped:""}},t._l(t.navList,(function(e,a){return n("v-list-tile",{key:a,attrs:{to:e.url,draggable:!1},on:{click:function(e){t.drawer=!1}}},[e.icon?n("v-list-tile-action",{staticStyle:{"margin-right":"0px"}},[n("v-icon",[t._v(t._s(e.icon||"grip-lines"))])],1):t._e(),n("v-list-tile-content",[n("v-list-tile-title",{staticStyle:{"font-size":"120%"}},[t._v(" "+t._s(e.name)+" ")])],1)],1)})),1)],1):t._e(),n("v-toolbar",[t.$vuetify.breakpoint.xsOnly?n("span",[n("div",{on:{click:function(e){t.drawer=!t.drawer}}},[n("v-icon",[t._v("fa-bars")])],1)]):t._e(),n("v-toolbar-title",{staticClass:"headline"},[n("router-link",{staticClass:"header-logo",staticStyle:{"text-decoration":"none",color:"white"},attrs:{to:"/"}},[n("span",[t._v("JSCARA")])])],1),t.$vuetify.breakpoint.smAndUp?n("v-spacer"):t._e(),t.$vuetify.breakpoint.smAndUp?n("span",t._l(t.navList,(function(e,a){return n("v-btn",{key:a,staticClass:"header-nav",attrs:{to:e.url}},[n("span",{staticClass:"mr-2"},[t._v(t._s(e.name))]),n("v-icon",[t._v("fas "+t._s(e.icon))])],1)})),1):t._e()],1)],1)},s=[],c=a["default"].extend({data:function(){return{drawer:!1}},computed:{navList:function(){var t=[];return t}}}),l=c,u=(n("fa53"),n("2877")),d=n("6544"),h=n.n(d),p=n("8336"),g=n("132d"),v=n("8860"),f=n("f774"),_=n("2fa4"),m=n("71d9"),b=n("2a7f"),w=Object(u["a"])(l,i,s,!1,null,"4afca754",null),y=w.exports;h()(w,{VBtn:p["a"],VIcon:g["a"],VList:v["a"],VNavigationDrawer:f["a"],VSpacer:_["a"],VToolbar:m["a"],VToolbarTitle:b["a"]});var x=a["default"].extend({name:"App",components:{Header:y}}),k=x,M=(n("034f"),n("7496")),S=n("a75b"),C=Object(u["a"])(k,o,r,!1,null,null,null),j=C.exports;h()(C,{VApp:M["a"],VContent:S["a"]});var O,E,R=n("8c4f"),L=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{staticStyle:{"padding-left":"24px"},attrs:{id:"serial-pane"}},[n("div",{attrs:{id:"notSupported"}},[t._v(" Sorry, "),n("b",[t._v("Web Serial")]),t._v(" is not supported on this device, make sure you're running Chrome 78 or later and have enabled the "),n("code",[t._v("#enable-experimental-web-platform-features")]),t._v(" flag in "),n("code",[t._v("chrome://flags")])]),n("v-card",{staticStyle:{padding:"14px","margin-bottom":"12px"}},[t.serial_connected?n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("v-text-field",{staticStyle:{"max-width":"500px","margin-right":"30px"},attrs:{label:"GCODE Command",outlined:"",autocomplete:"off"},nativeOn:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.write_cmd_to_serial(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.recover_prev_cmd(1)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.recover_prev_cmd(-1)}]},model:{value:t.cmd,callback:function(e){t.cmd=e},expression:"cmd"}}),n("v-btn",{staticStyle:{transform:"scale(1.2)"},on:{click:t.write_cmd_to_serial}},[t._v(" Send ")])],1):n("div",[t.attempting_to_connect?n("v-btn",{attrs:{color:"error"},on:{click:function(e){t.cancel_connect=!0}}},[t._v(" Cancel Connect to SCARA ")]):n("v-btn",{attrs:{color:"primary"},on:{click:t.serial_connect}},[t._v(" Connect to SCARA ")])],1),t.serial_connected?n("div",[n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:t.origin_scara}},[t._v(" Origin ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("G92 X0 Y0\n")}}},[t._v(" XY=0 ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("G92 Z0\n")}}},[t._v(" Z=0 ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("G92 X0 Y0 Z0\n")}}},[t._v(" XYZ=0 ")]),n("br"),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:t.clear_buffer}},[t._v(" Clear Buffer ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){t.write_serial("M410\n"),t.ready_to_send=!0}}},[t._v(" Quickstop ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("M112\n")}}},[t._v(" E-Stop ")]),n("br"),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.home_scara()}}},[t._v(" Home ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.home_scara(!0)}}},[t._v(" Fold-Up ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("M18\n")}}},[t._v(" Release ")]),n("br"),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("M106 S255\n")}}},[t._v(" Suck On ")]),n("v-btn",{staticStyle:{transform:"scale(0.85)"},on:{click:function(e){return t.write_serial("M106 S0\n")}}},[t._v(" Suck Off ")]),n("div",{staticStyle:{display:"flex","align-items":"stretch"}},[n("div",{staticClass:"jog-box"},[n("div",{staticClass:"jog-col"},[n("v-text-field",{staticStyle:{"text-align":"center"},attrs:{type:"number",step:"5"},model:{value:t.jog_inc["x"],callback:function(e){t.$set(t.jog_inc,"x",t._n(e))},expression:"jog_inc['x']"}}),n("v-btn",{staticClass:"jog-btn",on:{click:function(e){return t.write_serial("G91\nG0 X"+t.jog_inc["x"]+"\nG90\n")}}},[t._v(" +X ")]),n("v-btn",{staticClass:"jog-btn",on:{click:function(e){return t.write_serial("G91\nG0 X-"+t.jog_inc["x"]+"\nG90\n")}}},[t._v(" -X ")])],1),n("div",{staticClass:"jog-col"},[n("v-text-field",{staticStyle:{"text-align":"center"},attrs:{type:"number",step:"5"},model:{value:t.jog_inc["y"],callback:function(e){t.$set(t.jog_inc,"y",t._n(e))},expression:"jog_inc['y']"}}),n("v-btn",{staticClass:"jog-btn",on:{click:function(e){return t.write_serial("G91\nG0 Y"+t.jog_inc["y"]+"\nG90\n")}}},[t._v(" +Y ")]),n("v-btn",{staticClass:"jog-btn",on:{click:function(e){return t.write_serial("G91\nG0 Y-"+t.jog_inc["y"]+"\nG90\n")}}},[t._v(" -Y ")])],1),n("div",{staticClass:"jog-col"},[n("v-text-field",{staticStyle:{"text-align":"center"},attrs:{type:"number",step:"5"},model:{value:t.jog_inc["z"],callback:function(e){t.$set(t.jog_inc,"z",t._n(e))},expression:"jog_inc['z']"}}),n("v-btn",{staticClass:"jog-btn",on:{click:function(e){t.write_serial("G91\nG0 Z"+Math.max(1,t.jog_inc["z"])+"\nG90\n")}}},[t._v(" +Z ")]),n("v-btn",{staticClass:"jog-btn",on:{click:function(e){t.write_serial("G91\nG0 Z-"+Math.max(1,t.jog_inc["z"])+"\nG90\n")}}},[t._v(" -Z ")])],1)]),n("div",{staticStyle:{width:"240px",margin:"10px 20px",padding:"16px 30px","background-color":"#db7676","border-radius":"10px",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},[n("v-row",[n("v-text-field",{staticStyle:{width:"100px"},attrs:{type:"number",label:"X Position"},model:{value:t.goto.x,callback:function(e){t.$set(t.goto,"x",t._n(e))},expression:"goto.x"}}),n("div"),n("v-text-field",{staticStyle:{width:"100px"},attrs:{type:"number",label:"Y Position"},model:{value:t.goto.y,callback:function(e){t.$set(t.goto,"y",t._n(e))},expression:"goto.y"}})],1),n("v-row",{attrs:{justify:"center"}},[n("v-btn",{on:{click:t.goto_point}},[t._v("Go To")])],1)],1),n("ClickToMove",{on:{move:t.click_move}})],1)],1):t._e(),n("div",{staticStyle:{"margin-top":"14px","min-height":"20vh","max-height":"30vh",width:"100%","overflow-y":"scroll",border:"1px dotted #333"}},t._l(t.serial_log,(function(e,a){return n("span",{key:a,domProps:{innerHTML:t._s(e)}})})),0)]),n("v-expansion-panels",{attrs:{multiple:""}},[n("v-expansion-panel",[n("v-expansion-panel-header",{attrs:{color:"#333"}},[t._v(" GCode Creator ")]),n("v-expansion-panel-content",[n("GcodeCreator",{on:{gcodegen:t.gcode_from_gen}}),n("br"),void 0!=t.job_prog?n("v-progress-linear",{staticStyle:{"max-width":"400px"},attrs:{height:"25"},model:{value:t.job_prog,callback:function(e){t.job_prog=e},expression:"job_prog"}},[n("strong",[t._v(t._s(Math.round((t.job_prog+Number.EPSILON)*Math.pow(10,2))/Math.pow(10,2))+"%")])]):t._e(),n("br"),t.gcode.length>0?n("v-btn",{on:{click:t.send_gcode_job}},[t._v(" Send GCODE ")]):t._e(),t.gcode.length>0?n("v-btn",{on:{click:function(e){t.save_gcode(t.gcode.join("\n"))}}},[t._v(" Save GCODE ")]):t._e()],1)],1),n("v-expansion-panel",[n("v-expansion-panel-header",[t._v(" GCode Uploader ")]),n("v-expansion-panel-content",[n("v-file-input",{attrs:{placeholder:"Upload Cartesian GCODE"},on:{change:t.load_gcode_file}}),n("br"),t.gcode.length>0?n("v-btn",{on:{click:t.send_gcode_job}},[t._v(" Send Converted GCODE ")]):t._e()],1)],1),n("v-expansion-panel",[n("v-expansion-panel-header",[t._v(" SCARA Sim ")]),n("v-expansion-panel-content",[n("ScaraSim3D",{attrs:{uploaded_gcode:t.gcode.join("\n")}})],1)],1)],1)],1)},T=[],G=(n("99af"),n("4de4"),n("d3b7"),n("ac1f"),n("1276"),n("ddb0"),n("3835"));n("96cf");function A(){return new Worker(n.p+"js/serialworker.5327dec7.worker.js")}(function(t){t[t["SerialConnect"]=0]="SerialConnect",t[t["PushToBuffer"]=1]="PushToBuffer",t[t["ReplaceBuffer"]=2]="ReplaceBuffer",t[t["ClearBuffer"]=3]="ClearBuffer",t[t["StartJob"]=4]="StartJob"})(O||(O={})),function(t){t[t["SerialConnected"]=0]="SerialConnected",t[t["SerialError"]=1]="SerialError",t[t["SerialRecv"]=2]="SerialRecv",t[t["JobProg"]=3]="JobProg"}(E||(E={}));var P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("center",[n("h4",[t._v("Click To Jog")]),n("canvas",{staticStyle:{border:"1px solid black"},attrs:{id:"click-move-canvas",width:t.plot_width,height:t.plot_height}})])},F=[],X=(n("a9e3"),a["default"].extend({props:{arm_rad:{default:240,type:Number},x_offset:{default:0,type:Number},y_offset:{default:0,type:Number}},data:function(){return{plot_width:300,plot_height:150}},methods:{render_bed:function(){var t=this,e=this.plot_width-20,n=e/2/(this.arm_rad+10),a=2*this.arm_rad<e?this.arm_rad:this.arm_rad*n,o=a/2+(this.plot_width-a)/2,r=document.getElementById("click-move-canvas"),i=r.getContext("2d");i.clearRect(0,0,r.offsetWidth,r.offsetHeight),i.arc(o,0,a,0,180),i.stroke(),i.beginPath(),i.moveTo(o,0),i.lineTo(o,a),i.closePath(),i.stroke();var s=function(e){var a=r.getBoundingClientRect(),i=e.clientX-a.left-o,s=e.clientY-a.top;t.$emit("move",[-i/n,s/n])};r.addEventListener("mousedown",s)}},mounted:function(){var t=this;this.$nextTick((function(){t.render_bed()}))}})),Y=X,I=Object(u["a"])(Y,P,F,!1,null,null,null),N=I.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("a-scene",{staticStyle:{width:"600px",height:"400px",margin:"auto"},attrs:{embedded:"","vr-mode-ui":"enabled: false"}},[n("a-entity",[n("a-cylinder",{attrs:{position:"0 140 -44",radius:"8",height:"280",color:"#444444"}}),n("a-cylinder",{attrs:{position:"0 100 0",radius:"12",height:"200",color:"#CCCCCC",metalness:"0.5"}}),n("a-cylinder",{attrs:{position:"42 100 -60",radius:"12",height:"200",color:"#CCCCCC",metalness:"0.5"}}),n("a-cylinder",{attrs:{position:"-42 100 -60",radius:"12",height:"200",color:"#CCCCCC",metalness:"0.5"}})],1),n("a-entity",{attrs:{position:"0 "+t.z+" 0"}},[n("a-box",{attrs:{height:"5",width:"130",depth:"140",position:"0 0 -30"}}),n("a-entity",{attrs:{rotation:"0 "+t.a1+" 0",position:"0 10 0"}},[n("a-box",{attrs:{height:"10",width:"50",depth:"140",position:"0 0 70"}}),n("a-cylinder",{attrs:{position:"0 0 0",radius:"25",height:"10"}}),n("a-cylinder",{attrs:{position:"0 0 140",radius:"25",height:"10"}}),n("a-entity",{attrs:{rotation:"0 "+t.a2+" 0",position:"0 10 140"}},[n("a-box",{attrs:{height:"10",width:"50",depth:"140",position:"0 0 70"}}),n("a-cylinder",{attrs:{position:"0 0 0",radius:"25",height:"10"}}),n("a-cylinder",{attrs:{position:"0 0 140",radius:"25",height:"10"}}),n("a-cylinder",{attrs:{position:"0 -80 140",radius:"5",height:"160",color:"black"}})],1)],1)],1),n("a-entity",{attrs:{meshline:"lineWidth: 5; path: "+t.path_str+"; color: #E20049",position:t.x_offset+" 20 "+t.y_offset}}),n("a-plane",{attrs:{position:"0 0 0",rotation:"-90 0 0",width:"400",height:"400",color:"#7BC8A4"}}),n("a-sky",{attrs:{color:"#ECECEC"}}),n("a-entity",{attrs:{camera:"","look-controls":"","orbit-controls":"target: 0 0 0; minDistance: 200; maxDistance: 600; initialPosition: 200 200 200"}})],1),n("br"),n("br"),n("v-slider",{attrs:{label:"Near Arm Angle","thumb-color":"red","thumb-label":"always",min:"-90",max:"90"},model:{value:t.a1,callback:function(e){t.a1=e},expression:"a1"}}),n("v-slider",{attrs:{label:"Far Arm Angle‏‏‎ ‎‎","thumb-color":"red","thumb-label":"always",min:"-90",max:"90"},model:{value:t.a2,callback:function(e){t.a2=e},expression:"a2"}})],1)},q=[],Z=(n("13d5"),n("fb6a"),n("5319"),n("d74a")),V=a["default"].extend({props:{x_offset:Number,y_offset:Number,uploaded_gcode:String},data:function(){return{z:180,a1:0,a2:0,a1_start_angle:0,a2_start_angle:0,a1_len:140,a2_len:140,path:[]}},methods:{gen_path:function(t){t=t.replace(/[N]\d+(?= [^G])/g,"G1"),t=t.replace(/[N]\d+ /g,"");var e=[0,0,0],n=t.split("\n").reduce((function(t,n){var a=Z.parseLine(n);if(0===a.words.length)return t;var o=e.slice();for(var r in a.words){var i=a.words[r];"X"===i[0]&&(o[0]=i[1]),"Y"===i[0]&&(o[2]=i[1]),"Z"===i[0]&&(o[1]=i[1])}return e=o,t.push(o),t}),[]);this.path=n}},watch:{uploaded_gcode:function(){this.gen_path(this.uploaded_gcode)}},computed:{path_str:function(){return this.path.reduce((function(t,e){return"".concat(t).concat(""!=t?",":""," ").concat(e[0]," ").concat(e[1]," ").concat(e[2])}),"")},x2:function(){var t=Math.cos((this.a1+this.a1_start_angle)*Math.PI/180)*this.a1_len,e=t+Math.cos((this.a2+this.a2_start_angle)*Math.PI/180)*this.a2_len;return e},y2:function(){var t=Math.sin((this.a1+this.a1_start_angle)*Math.PI/180)*this.a1_len,e=t+Math.sin((this.a2+this.a2_start_angle)*Math.PI/180)*this.a2_len;return e}},mounted:function(){var t=this;this.$nextTick((function(){t.gen_path(t.uploaded_gcode)}))}}),$=V,D=n("ba0d"),z=Object(u["a"])($,B,q,!1,null,null,null),U=z.exports;h()(z,{VSlider:D["a"]});var H=n("9e3e"),W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-card",{staticStyle:{"padding-bottom":"10px"},attrs:{color:"#333"}},[n("v-tabs",{staticStyle:{color:"white"},attrs:{"background-color":"grey darken-4"},on:{change:t.gcode_convert_debounce},model:{value:t.active_tab,callback:function(e){t.active_tab=e},expression:"active_tab"}},[n("v-tab",{key:"txt"},[t._v("Text")]),n("v-tab",{key:"img"},[t._v("Image")]),n("v-tabs-items",{staticStyle:{"background-color":"#333",padding:"10px"},model:{value:t.active_tab,callback:function(e){t.active_tab=e},expression:"active_tab"}},[n("v-tab-item",{key:"txt"},[n("div",{staticStyle:{width:"500px","max-width":"100%",display:"flex","flex-wrap":"wrap","justify-content":"space-around"}},[n("v-text-field",{attrs:{label:"Custom Text"},on:{change:t.gcode_convert_debounce},model:{value:t.userText,callback:function(e){t.userText=e},expression:"userText"}}),n("v-text-field",{attrs:{type:"number",label:"Font Size"},on:{change:t.gcode_convert_debounce},model:{value:t.fontSize,callback:function(e){t.fontSize=t._n(e)},expression:"fontSize"}}),n("v-select",{attrs:{items:t.fontOptions,label:"Font","item-text":"name","item-value":"file"},on:{change:t.gcode_convert_debounce},model:{value:t.fontName,callback:function(e){t.fontName=e},expression:"fontName"}})],1)]),n("v-tab-item",{key:"img"},[n("div",{staticStyle:{width:"500px","max-width":"100%"}},[n("v-file-input",{attrs:{placeholder:"Upload Image",accept:".svg,.png,.jpg,.jpeg"},on:{change:t.load_img_file}}),"photo"==t.imageType?n("div",[n("br"),n("v-radio-group",{attrs:{row:""},on:{change:t.photo_to_svg},model:{value:t.photo_mode,callback:function(e){t.photo_mode=e},expression:"photo_mode"}},[n("v-radio",{attrs:{value:"squiggle",label:"Squiggle"}}),n("v-radio",{attrs:{value:"tsp",label:"Traveling Salesman"}}),n("v-radio",{attrs:{value:"potrace",label:"Potrace"}})],1),n("br"),"potrace"==t.photo_mode?n("div",[n("v-slider",{attrs:{"thumb-label":"always",min:"-1",max:"255",label:"Threshold"},on:{change:t.photo_to_svg},scopedSlots:t._u([{key:"append",fn:function(){return[n("v-icon",{directives:[{name:"ripple",rawName:"v-ripple"},{name:"show",rawName:"v-show",value:-1!=t.potrace_params.threshold,expression:"potrace_params.threshold != -1"}],on:{click:function(e){t.potrace_params.threshold=-1}}},[t._v(" mdi-replay ")])]},proxy:!0}],null,!1,1542438017),model:{value:t.potrace_params.threshold,callback:function(e){t.$set(t.potrace_params,"threshold",e)},expression:"potrace_params.threshold"}}),n("br"),n("v-slider",{attrs:{"thumb-label":"always",min:"0",max:"50",label:"Min Speckle Size"},on:{change:t.photo_to_svg},model:{value:t.potrace_params.turdSize,callback:function(e){t.$set(t.potrace_params,"turdSize",e)},expression:"potrace_params.turdSize"}}),n("br"),n("v-checkbox",{attrs:{label:"Invert"},on:{change:t.photo_to_svg},model:{value:t.potrace_params.blackOnWhite,callback:function(e){t.$set(t.potrace_params,"blackOnWhite",e)},expression:"potrace_params.blackOnWhite"}})],1):t._e(),"squiggle"==t.photo_mode?n("div",[n("v-slider",{attrs:{"thumb-label":"always",min:"5",max:"256",label:"Frequency"},on:{change:t.photo_to_svg},model:{value:t.squiggle_config.frequency,callback:function(e){t.$set(t.squiggle_config,"frequency",e)},expression:"squiggle_config.frequency"}}),n("v-slider",{attrs:{"thumb-label":"always",min:"10",max:"200",label:"# Lines"},on:{change:t.photo_to_svg},model:{value:t.squiggle_config.lineCount,callback:function(e){t.$set(t.squiggle_config,"lineCount",e)},expression:"squiggle_config.lineCount"}}),n("v-slider",{attrs:{"thumb-label":"always",min:"0.1",max:"5",step:"0.1",label:"Amplitude"},on:{change:t.photo_to_svg},model:{value:t.squiggle_config.amplitude,callback:function(e){t.$set(t.squiggle_config,"amplitude",e)},expression:"squiggle_config.amplitude"}}),n("v-slider",{attrs:{"thumb-label":"always",min:"0.5",max:"3",step:"0.1",label:"Sampling"},on:{change:t.photo_to_svg},model:{value:t.squiggle_config.spacing,callback:function(e){t.$set(t.squiggle_config,"spacing",e)},expression:"squiggle_config.spacing"}})],1):t._e(),"tsp"==t.photo_mode?n("div",[n("v-slider",{attrs:{"thumb-label":"always",min:"5",max:"30",label:"Resolution",disabled:t.tsp_config.in_progress},on:{change:function(e){t.tsp_config.auto_regen&&t.photo_to_svg()}},model:{value:t.tsp_config.resolution,callback:function(e){t.$set(t.tsp_config,"resolution",e)},expression:"tsp_config.resolution"}}),n("v-slider",{attrs:{"thumb-label":"always",min:"0",max:"100",step:"5",label:"Contrast",disabled:t.tsp_config.in_progress},on:{change:function(e){t.tsp_config.auto_regen&&t.photo_to_svg()}},model:{value:t.tsp_config.contrast,callback:function(e){t.$set(t.tsp_config,"contrast",e)},expression:"tsp_config.contrast"}}),n("v-slider",{attrs:{"thumb-label":"always",min:"0",max:"255",step:"5",label:"White Cutoff",disabled:t.tsp_config.in_progress},on:{change:function(e){t.tsp_config.auto_regen&&t.photo_to_svg()}},model:{value:t.tsp_config.whiteCutoff,callback:function(e){t.$set(t.tsp_config,"whiteCutoff",e)},expression:"tsp_config.whiteCutoff"}}),n("v-checkbox",{attrs:{label:"Invert"},on:{change:function(e){t.tsp_config.auto_regen&&t.photo_to_svg()}},model:{value:t.tsp_config.invert,callback:function(e){t.$set(t.tsp_config,"invert",e)},expression:"tsp_config.invert"}}),n("v-checkbox",{attrs:{label:"Auto Regen"},model:{value:t.tsp_config.auto_regen,callback:function(e){t.$set(t.tsp_config,"auto_regen",e)},expression:"tsp_config.auto_regen"}}),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:!t.tsp_config.auto_regen,expression:"!tsp_config.auto_regen"}],attrs:{label:"Regen"},on:{click:t.photo_to_svg}},[t._v(" Regenerate ")])],1):t._e()],1):t._e()],1)])],1)],1),n("div",{style:{width:t.plot_width+2+"px",height:t.plot_height+2+"px",position:"relative",overflow:"hidden",margin:"10px","background-color":"#666"}},[n("drr",{attrs:{x:t.svg_x,y:t.svg_y,w:t.svg_w,h:t.svg_h,angle:t.svg_rot,aspectRatio:""},on:{change:t.svg_moved}},[n("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"svg-drr"}})]),n("canvas",{staticStyle:{border:"1px solid black"},attrs:{id:"render-workarea",width:t.plot_width,height:t.plot_height}})],1),n("div",{staticClass:"visuallyhidden",attrs:{id:"svg-tester"}})],1)],1)},J=[],Q=(n("4160"),n("a630"),n("caad"),n("a15b"),n("d81d"),n("26e9"),n("35b3"),n("3ca3"),n("159b"),n("2b3d"),n("2909")),K=n("a788"),tt=n("d4ec"),et=n("bee2"),nt=Math.PI,at=2*nt,ot={approximationScale:1,curve_distance_epsilon:1e-30,curveColinearityEpsilon:1e-30,curveAngleToleranceEpsilon:.01,angleTolerance:.4,recursionLimit:32,cuspLimit:0},rt=function(){function t(e,n){var a=this;Object(tt["a"])(this,t),this.svgPathIterator=function(t,e,n,o){var r,i,s,c,l,u,d,h,p,g=t[0],v=!1;switch(g){case"M":for(r=1;r<t.length;r+=2)i=t[r],s=t[r+1],a.consumer(n,o,i,s,e,["M",i,s]),n=i,o=s;break;case"L":for(r=1;r<t.length;r+=2)i=t[r],s=t[r+1],a.consumer(n,o,i,s,e,["L",i,s]),n=i,o=s;break;case"H":for(s=o,r=1;r<t.length;r+=2)i=t[r],a.consumer(n,o,i,s,e,["H",i]),n=i;break;case"V":for(i=n,r=1;r<t.length;r+=2)s=t[r],a.consumer(n,o,i,s,e,["V",s]),o=s;break;case"Z":a.consumer(n,o,n,o,e,["Z"]);break;case"Q":v=!0;case"C":var f=v?4:6;for(r=1;r<t.length;r+=f)i=n,s=o,c=t[r],l=t[r+1],u=v?c:t[r+2],d=v?l:t[r+3],h=v?t[r+2]:t[r+4],p=v?t[r+3]:t[r+5],a.linearize(i,s,c,l,u,d,h,p,e),n=i,o=s;break;default:throw new Error("path command '"+g+"' not supported yet")}},this.consumer=function(t,n,o,r,i,s){e(t,n,o,r,i,s),a.prevX=o,a.prevY=r},this.opts=Object.assign({},ot,n),this.prevX=0,this.prevY=0}return Object(et["a"])(t,[{key:"linearize",value:function(t,e,n,a,o,r,i,s,c){this.linearizeRecursive(t,e,n,a,o,r,i,s,c,0);var l=this.prevX,u=this.prevY;l===i&&u===s||this.consumer(l,u,i,s,c,["L",i,s])}},{key:"distanceTo",value:function(t,e,n,a){var o=n-t,r=a-e;return Math.sqrt(o*o+r*r)}},{key:"linearizeRecursive",value:function(t,e,n,a,o,r,i,s,c,l){var u,d,h,p=this.opts.cuspLimit,g=this.opts.curveColinearityEpsilon,v=this.opts.curveAngleToleranceEpsilon,f=this.opts.angleTolerance,_=Math.pow(.5/this.opts.approximationScale,2),m=(t+n)/2,b=(e+a)/2,w=(n+o)/2,y=(a+r)/2,x=(o+i)/2,k=(r+s)/2,M=(m+w)/2,S=(b+y)/2,C=(w+x)/2,j=(y+k)/2,O=(M+C)/2,E=(S+j)/2,R=i-t,L=s-e,T=Math.abs((n-i)*L-(a-s)*R),G=Math.abs((o-i)*L-(r-s)*R);switch((T>g?2:0)+(G>g?1:0)){case 0:if(h=R*R+L*L,0===h)T=this.distanceTo(t,e,n,a),G=this.distanceTo(i,s,o,r);else{if(h=1/h,u=n-t,d=a-e,T=h*(u*R+d*L),u=o-t,d=r-e,G=h*(u*R+d*L),T>0&&T<1&&G>0&&G<1)return void this.consumer(t,e,i,s,c,["L",i,s]);T=T<=0?this.distanceTo(n,a,t,e):T>=1?this.distanceTo(n,a,i,s):this.distanceTo(n,a,t+T*R,e+T*L),G=G<=0?this.distanceTo(o,r,t,e):G>=1?this.distanceTo(o,r,i,s):this.distanceTo(o,r,t+G*R,e+G*L)}if(T>G){if(T<_)return void this.consumer(t,e,n,a,c,["L",n,a])}else if(G<_)return void this.consumer(t,e,o,r,c,["L",o,r]);break;case 1:if(G*G<=_*(R*R+L*L)){if(f<v)return void this.consumer(t,e,w,y,c,["L",w,y]);if(u=Math.abs(Math.atan2(s-r,i-o)-Math.atan2(r-a,o-n)),u>=nt&&(u=at-u),u<f)return this.consumer(t,e,n,a,c,["L",n,a]),void this.consumer(n,a,o,r,c,["L",o,r]);if(0!==p&&u>nt-p)return void this.consumer(t,e,o,r,c,["L",o,r])}break;case 2:if(T*T<=_*(R*R+L*L)){if(f<v)return void this.consumer(t,e,w,y,c,["L",w,y]);if(u=Math.abs(Math.atan2(r-a,o-n)-Math.atan2(a-e,n-t)),u>=nt&&(u=at-u),u<f)return this.consumer(t,e,n,a,c,["L",n,a]),void this.consumer(n,a,o,r,c,["L",o,r]);if(0!==p&&u>nt-p)return void this.consumer(t,e,n,a,c,["L",n,a])}break;case 3:if((T+G)*(T+G)<=_*(R*R+L*L)){if(f<v)return void this.consumer(t,e,w,y,c,["L",w,y]);if(h=Math.atan2(r-a,o-n),u=Math.abs(h-Math.atan2(a-e,n-t)),d=Math.abs(Math.atan2(s-r,i-o)-h),u>=nt&&(u=at-u),d>=nt&&(d=at-d),u+d<f)return void this.consumer(t,e,w,y,c,["L",w,y]);if(0!==p){if(u>nt-p)return void this.consumer(t,e,n,a,c,["L",n,a]);if(d>nt-p)return void this.consumer(t,e,o,r,c,["L",o,r])}}break}var A=l+1;A>=this.opts.recursionLimit?this.consumer(t,e,i,s,c,["L",i,s]):(this.linearizeRecursive(t,e,m,b,M,S,O,E,c,A),this.linearizeRecursive(O,E,C,j,x,k,i,s,c,A))}}]),t}(),it=n("84fa"),st=n.n(it),ct=n("cd7e"),lt=n.n(ct),ut=n("f46b"),dt=new Worker("oneline.js");dt.onmessage=vt;var ht=1;function pt(t){var e={type:"setImage",seq:ht++,data:t};dt.postMessage(e)}function gt(t){var e={type:"build",seq:ht++,options:JSON.stringify(t)};dt.postMessage(e)}function vt(t){ft.onResult&&ft.onResult(t.data)}var ft={worker:dt,setImage:pt,build:gt,onResult:void 0},_t=ft;function mt(t){var e=t.childNodes;while(e.length)e[0].remove();for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];t.append.apply(t,a)}var bt=a["default"].extend({props:{arm_rad:{default:240,type:Number},svgdoc:Document},data:function(){var t=1.5;return{active_tab:0,userText:"SCARA",fontName:"ChunkFive-Regular.otf",fontSize:40,userInputDebounce:0,fontOptions:[{name:"Allura (Script)",file:"Allura-Regular.otf"},{name:"ChunkFive (block)",file:"ChunkFive-Regular.otf"},{name:"GreatVibes (caligraphy)",file:"GreatVibes-Regular.ttf"}],photo_mode:"squiggle",photo_upload_max_dim:500,potrace_params:{threshold:-1,turdSize:15,blackOnWhite:!0},squiggle_config:{black:!1,frequency:100,amplitude:2,lineCount:50,brightness:0,contrast:0,minBrightness:0,maxBrightness:255,spacing:.5},tsp_config:{resolution:20,contrast:80,whiteCutoff:240,invert:!1,lineWidth:4,fg:"black",bg:"white",auto_regen:!1,in_progress:!1},plot_scale:t,plot_width:2*this.arm_rad*t,plot_height:this.arm_rad*t,svg_x:240*t,svg_y:100*t,svg_w:200,svg_h:200,orig_svg_w:200,orig_svg_h:200,svg_rot:0,raw_photo:void 0,photo_blob:void 0,raw_svg:"",imageType:""}},methods:{gcode_convert_debounce:function(){var t=this;clearTimeout(this.userInputDebounce),this.userInputDebounce=setTimeout((function(){return t.gcode_convert()}),500)},gcode_convert:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=this.active_tab){t.next=8;break}return t.t0=this,t.next=4,regeneratorRuntime.awrap(this.text_to_svg());case 4:t.t1=t.sent,t.t0.display_svg.call(t.t0,t.t1),t.next=9;break;case 8:this.active_tab;case 9:this.svg_to_gcode();case 10:case"end":return t.stop()}}),null,this)},svg_to_gcode:function(){var t=this,e=4,n=[],a="",o=[0,0],r=document.getElementById("svg-render"),i=Array.from(r.querySelectorAll("path").values()).reduce((function(t,e){var n=e.getAttribute("d");return t.push(n),t}),[]);i.forEach((function(r){var i=st()(r).scale(t.svg_w/t.orig_svg_w,t.svg_h/t.orig_svg_h).rotate(t.svg_rot,t.svg_w/2,t.svg_h/2).translate(t.svg_x-t.svg_w/2,t.svg_y-t.svg_h/2).unarc().abs().round(4),s=[],c=[],l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Math.round((t+Number.EPSILON)*Math.pow(10,e))/Math.pow(10,e)},u=function(n,a,r,i,u,d){r=l(-(r/t.plot_scale-t.arm_rad)),i=l(i/t.plot_scale),d&&("M"==d[0]?(s.push(["G0","Z".concat(e)]),s.push(["G0","X".concat(r),"Y".concat(i)]),s.push(["G0","Z0"]),o=[r,i]):"Z"==d[0]?s.push(["G0","X".concat(o[0]),"Y".concat(o[1])]):s.push(["G1","X".concat(r),"Y".concat(i)]),c.push(d.join(" ")))},d=new rt(u,{approximationScale:2,recursionLimit:8,curve_distance_epsilon:1e-5,curveColinearityEpsilon:1e-5});i.iterate(d.svgPathIterator),console.log(s.map((function(t){return t.join("")}))),n=s.map((function(t){return t.join("")})).reduce((function(t,e){return t.push(e),t}),[]),a=a+" "+c.join(" ")})),console.log(n),this.$emit("gcodegen",n)},opentype_promise_font:function(t){return new Promise((function(e,n){K["a"].load(t,(function(t,a){t?(alert("Font could not be loaded: "+t),n(t)):e(a)}))}))},text_to_svg:function(){var t=this;this.arm_rad,this.plot_width,this.arm_rad;return this.opentype_promise_font("fonts/".concat(this.fontName)).then((function(e){var n=e.getPath(t.userText,0,t.fontSize,t.fontSize),a=n.getBoundingBox();t.svg_w=a.x2-a.x1,t.svg_h=a.y2-a.y1,t.orig_svg_w=a.x2-a.x1,t.orig_svg_h=a.y2-a.y1;var o=n.toSVG(6),r=document.createElementNS("http://www.w3.org/2000/svg","svg");return r.innerHTML=o,r.setAttribute("viewBox","".concat(a.x1,", ").concat(a.y1,", ").concat(t.svg_w," ").concat(t.svg_h)),r}))},set_svg_viewport:function(){var t=document.getElementById("svg-tester").getElementsByTagName("svg")[0],e=t.getBBox();this.svg_w=e.width,this.svg_h=e.height,this.orig_svg_w=e.width,this.orig_svg_h=e.height;var n=this.svg_w/this.svg_h,a=200;(this.svg_w>a||this.svg_h>a)&&(n>=1?(this.svg_w=a,this.svg_h=a/n):(this.svg_h=a,this.svg_w=a*n)),t.setAttribute("viewBox","".concat(e.x," ").concat(e.y," ").concat(e.width," ").concat(e.height)),this.display_svg(t),this.svg_to_gcode()},load_img_file:function(t){var e,n=this;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(null!==t){a.next=2;break}return a.abrupt("return");case 2:if(e=new FileReader,"image/svg+xml"!=t.type){a.next=8;break}e.onload=function(t){n.raw_svg=e.result;var a=(new DOMParser).parseFromString(n.raw_svg,"image/svg+xml");mt(document.getElementById("svg-tester"),a.documentElement),n.set_svg_viewport()},e.readAsText(t),a.next=15;break;case 8:if(!["image/jpeg","image/jpg","image/png"].includes(t.type)){a.next=14;break}return e.onload=function(t){n.imageType="photo",n.raw_photo=e.result,n.photo_to_svg()},a.next=12,regeneratorRuntime.awrap(Object(ut["a"])().toBlob(t,{max:this.photo_upload_max_dim}).then((function(t){n.photo_blob=t,e.readAsArrayBuffer(t)})));case 12:a.next=15;break;case 14:this.imageType="";case 15:case"end":return a.stop()}}),null,this)},photo_to_svg:function(){var t=this;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:if("potrace"==this.photo_mode&&void 0!=this.raw_photo&&lt.a.trace(this.raw_photo,this.potrace_params,(function(e,n){if(e)throw e;var a=(new DOMParser).parseFromString(n,"image/svg+xml");mt(document.getElementById("svg-tester"),a.documentElement),t.set_svg_viewport()})),"squiggle"!=this.photo_mode){e.next=4;break}return e.next=4,regeneratorRuntime.awrap(this.photo_to_svg_squiggle());case 4:"tsp"==this.photo_mode&&(_t.setImage(this.raw_photo),this.tsp_config.in_progress=!0,_t.onResult=function(e){var n=e.result;t.tsp_config.in_progress=!1;var a=(new DOMParser).parseFromString(n,"image/svg+xml");mt(document.getElementById("svg-tester"),a.documentElement),t.set_svg_viewport()},_t.build(this.tsp_config));case 5:case"end":return e.stop()}}),null,this)},photo_to_svg_squiggle:function(){var t,e,n,a,o,r,i,s,c,l,u,d,h,p,g=this,v=arguments;return regeneratorRuntime.async((function(f){while(1)switch(f.prev=f.next){case 0:return t=!(v.length>0&&void 0!==v[0])||v[0],e=this.squiggle_config,n=e.contrast,a=e.brightness,o=e.lineCount,r=e.minBrightness,i=e.maxBrightness,s=e.spacing,c=e.black,u=document.createElement("canvas"),d=u.getContext("2d"),h=new Image,p=new Promise((function(p,v){h.onload=function(){var v,f=h.width,_=h.height;u.width=f,u.height=_,d.drawImage(h,0,0),l=d.getImageData(0,0,f,_);for(var m,b,w=[],y=5,x=0,k=[],M=0,S=0,C=259*(n+255)/(255*(259-n)),j=Math.floor(_/o),O=!1,E=0;E<_;E+=j){x=0,k=[],k.push([0,E]),M=E*f;for(var R=s;R<f;R+=s)S=Math.floor(R+M),m=0!==n?.2125*(C*(l.data[4*S]-128)+128+a)+.7154*(C*(l.data[4*(S+1)]-128)+128+a)+.0721*(C*(l.data[4*(S+2)]-128)+128+a):.2125*(l.data[4*S]+a)+.7154*(l.data[4*(S+1)]+a)+.0721*(l.data[4*(S+2)]+a),c?(m=Math.min(255-r,255-m),b=Math.max(i-m,0)):(m=Math.max(r,m),b=Math.max(i-m,0)),y=e.amplitude*b/o,x+=b/e.frequency,k.push([R,E+Math.sin(x)*y]);O&&(k=k.reverse()),w.push(k),t&&(O=!O)}w=[(v=[]).concat.apply(v,Object(Q["a"])(w))];var L=w.map((function(t){var e="";return t.map((function(t,n){e+=0===n?"M ".concat(t[0],",").concat(t[1]):"L".concat(Math.round(100*t[0])/100,",").concat(Math.round(100*t[1])/100)})),'<path d="'.concat(e,'"/>')})),T='<svg xmlns="http://www.w3.org/2000/svg">'.concat(L.join("\n"),"</svg>"),G=(new DOMParser).parseFromString(T,"image/svg+xml");console.log(G),mt(document.getElementById("svg-tester"),G.documentElement),g.set_svg_viewport(),p(void 0)}})),h.src=URL.createObjectURL(this.photo_blob),f.abrupt("return",p);case 15:case"end":return f.stop()}}),null,this)},display_svg:function(t){t.style.width="100%",t.style.height="100%",t.setAttribute("width",this.svg_w+"px"),t.setAttribute("height",this.svg_h+"px"),t.id="svg-render",mt(document.getElementById("svg-drr"),t)},svg_moved:function(t){console.log(t),this.svg_x=t.x,this.svg_y=t.y,this.svg_w=t.w,this.svg_h=t.h,this.svg_rot=t.angle,this.gcode_convert_debounce()},render_workarea:function(){var t=this.plot_width/2,e=document.getElementById("render-workarea"),n=e.getContext("2d");n.clearRect(0,0,e.offsetWidth,e.offsetHeight),n.arc(t,0,t,0,180),n.stroke(),n.beginPath(),n.moveTo(t,0),n.lineTo(t,this.plot_width),n.closePath(),n.stroke()}},mounted:function(){var t=this;this.$nextTick((function(){t.render_workarea(),t.gcode_convert()}))}}),wt=bt,yt=(n("1888"),n("b0af")),xt=n("ac7c"),kt=n("23a7"),Mt=n("67b6"),St=n("43a6"),Ct=n("b974"),jt=n("71a3"),Ot=n("c671"),Et=n("fe57"),Rt=n("aac8"),Lt=n("8654"),Tt=n("269a"),Gt=n.n(Tt),At=n("5607"),Pt=Object(u["a"])(wt,W,J,!1,null,null,null),Ft=Pt.exports;h()(Pt,{VBtn:p["a"],VCard:yt["a"],VCheckbox:xt["a"],VFileInput:kt["a"],VIcon:g["a"],VRadio:Mt["a"],VRadioGroup:St["a"],VSelect:Ct["a"],VSlider:D["a"],VTab:jt["a"],VTabItem:Ot["a"],VTabs:Et["a"],VTabsItems:Rt["a"],VTextField:Lt["a"]}),Gt()(Pt,{Ripple:At["a"]});var Xt=new A,Yt=a["default"].extend({components:{ClickToMove:N,ScaraSim3D:U,GcodeCreator:Ft},data:function(){return{gcode:[],send_buffer:[],ready_to_send:!0,last_resp:void 0,send_buffer_interval:void 0,send_log:[],send_log_index:0,recv_buffer:"",serial_log:[],cmd:"",jog_inc:{x:10,y:10,z:10},goto:{x:0,y:0},serial_connected:!1,attempting_to_connect:!1,cancel_connect:!1,reader:void 0,writer:void 0,regen_debounce:0,job_prog:void 0}},methods:{click_move:function(t){var e,n,a;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:e=Object(G["a"])(t,2),n=e[0],a=e[1],this.goto.x=n,this.goto.y=a,this.goto_point();case 4:case"end":return o.stop()}}),null,this)},goto_point:function(){var t;return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return t="G0 X".concat(this.goto.x," Y").concat(this.goto.y," F20000\n"),e.next=3,regeneratorRuntime.awrap(this.write_serial(t));case 3:case"end":return e.stop()}}),null,this)},home_scara:function(){var t,e,n,a,o,r,i=arguments;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:t=i.length>0&&void 0!==i[0]&&i[0],e=["G28"],n=["G28","G0 F20000","G0 X120 Y120 Z5 F20000"],a=t?e:n,s.t0=regeneratorRuntime.keys(a);case 5:if((s.t1=s.t0()).done){s.next=12;break}return o=s.t1.value,r=a[o],s.next=10,regeneratorRuntime.awrap(this.write_serial(r+"\n"));case 10:s.next=5;break;case 12:case"end":return s.stop()}}),null,this)},origin_scara:function(){var t,e,n;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:t=["G0 Z30 F5000","G0 X0 Y0 F5000","G0 Z0 F5000"],a.t0=regeneratorRuntime.keys(t);case 2:if((a.t1=a.t0()).done){a.next=9;break}return e=a.t1.value,n=t[e],a.next=7,regeneratorRuntime.awrap(this.write_serial(n+"\n"));case 7:a.next=2;break;case 9:case"end":return a.stop()}}),null,this)},recover_prev_cmd:function(t){this.cmd==this.send_log[this.send_log_index]?(this.send_log_index+=t,this.send_log_index<this.send_log.length&&(this.cmd=this.send_log[this.send_log_index])):this.send_log.length>0&&(this.send_log_index=0,this.cmd=this.send_log[this.send_log_index])},write_cmd_to_serial:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.write_serial(this.cmd+"\n"));case 2:this.send_log.unshift(this.cmd),this.cmd="";case 4:case"end":return t.stop()}}),null,this)},write_serial:function(t){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:Xt.postMessage({type:O.PushToBuffer,data:[t]});case 1:case"end":return e.stop()}}))},serial_connect:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(navigator.serial.requestPort());case 2:Xt.postMessage({type:O.SerialConnect});case 3:case"end":return t.stop()}}))},load_gcode_file:function(t){var e=this;if(null!==t){var n=new FileReader;n.onload=function(t){e.gcode=t.target.result.split("\n")},n.readAsText(t)}},gcode_from_gen:function(t){this.gcode=["G28 O","G0 Z10 X120 Y120 F20000"].concat(t,["G0Z10"]).filter((function(t){return t.length>0}))},save_gcode:function(t){Object(H["a"])(new Blob([t],{type:"text/plain"}),"jscara_export.gcode")},clear_buffer:function(){Xt.postMessage({type:O.ClearBuffer}),this.ready_to_send=!0},send_gcode_job:function(){return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:Xt.postMessage({type:O.StartJob,data:this.gcode}),this.job_prog=0;case 2:case"end":return t.stop()}}),null,this)}},mounted:function(){var t=this;if(void 0!==navigator.serial){var e=document.getElementById("notSupported");e.style.display="none"}Xt.onmessage=function(e){var n=e.data;n.type==E.SerialConnected?t.serial_connected=!0:n.type==E.SerialRecv?t.serial_log.unshift(n.data):n.type==E.JobProg?100==n.data?(t.job_prog=void 0,t.$toast("Job Complete!",{x:"center",color:"green"})):t.job_prog=n.data:n.type==E.SerialError&&t.$toast(n.data,{x:"center",color:"red"})}}}),It=Yt,Nt=(n("cccb"),n("a523")),Bt=n("cd55"),qt=n("49e2"),Zt=n("c865"),Vt=n("0393"),$t=n("8e36"),Dt=n("0fd9"),zt=Object(u["a"])(It,L,T,!1,null,null,null),Ut=zt.exports;h()(zt,{VBtn:p["a"],VCard:yt["a"],VContainer:Nt["a"],VExpansionPanel:Bt["a"],VExpansionPanelContent:qt["a"],VExpansionPanelHeader:Zt["a"],VExpansionPanels:Vt["a"],VFileInput:kt["a"],VProgressLinear:$t["a"],VRow:Dt["a"],VTextField:Lt["a"]});var Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"scara-converter"}},[n("v-file-input",{on:{change:t.load_gcode_file}})],1)},Wt=[],Jt=(n("b0c0"),n("a4d3"),n("cb29"),n("4057"),n("b680"),n("e439"),n("dbb4"),n("b64b"),n("acd8"),n("ade3"));function Qt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qt(Object(n),!0).forEach((function(e){Object(Jt["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var te,ee=n("d74a");(function(t){t[t["Left"]=-1]="Left",t[t["Right"]=1]="Right"})(te||(te={}));var ne={L1:120,L2:120,a1_driver_teeth:20,a1_receiver_teeth:80,a1_steps_per_rev:50,a2_driver_teeth:20,a2_receiver_teeth:80,a2_secondary_receiver_teeth:80,a2_steps_per_rev:50,max_speed:2e4,x_estop_offset:185,y_estop_offset:115},ae=function(){function t(e){Object(tt["a"])(this,t),this.last_hand=te.Right,this.x_offset=0,this.y_offset=100,this.inner_rad=0,this.skew=0,this.feed_rate=2e3,this.pref_hand=te.Right,this.max_seg_length=.1,this.scara_props=ne,this.error_reporter=e||function(t){alert&&alert(t)}}return Object(et["a"])(t,[{key:"valid_point",value:function(t,e){return e<=Math.sqrt(Math.pow(this.scara_props.L1+this.scara_props.L2,2)-Math.pow(t,2))}},{key:"parse_gcode_move",value:function(t){var e={X:void 0,Y:void 0,Z:void 0,F:void 0,E:void 0};for(var n in t){var a=t[n];"X"===a[0]&&(e.X=a[1]),"Y"===a[0]&&(e.Y=a[1]),"Z"===a[0]&&(e.Z=a[1]),"E"===a[0]&&(e.E=a[1]),"F"===a[0]&&(e.F=a[1])}return e}},{key:"scara_distance",value:function(t,e){return Math.sqrt(Math.pow(e.a1-t.a1,2)+Math.pow(e.a2-t.a2,2)+Math.pow(e.Z-t.Z,2))}},{key:"map_cartesian_to_scara",value:function(t){var e=this,n=void 0,a=function(a,o){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i={a1:0,a2:0,hand:e.last_hand*(r?-1:1),F:0,Z:0,E:0},s=Math.hypot(a,o),c=Math.atan2(o,a);if(i.a1=180*(c+i.hand*Math.acos((Math.pow(s,2)+Math.pow(e.scara_props.L1,2)-Math.pow(e.scara_props.L2,2))/(2*e.scara_props.L1*s)))/Math.PI,i.a2=180*(c-i.hand*Math.acos((Math.pow(s,2)+Math.pow(e.scara_props.L2,2)-Math.pow(e.scara_props.L1,2))/(2*e.scara_props.L2*s)))/Math.PI,isNaN(i.a1)||isNaN(i.a2))return n="ERROR: Conversion failed - GCODE results in NaNs!",void console.log(n,t,i,e.valid_point(a,o));if(i.a1>=180||i.a1<=-180)return n="ERROR: Conversion failed: GCODE falls outside useable work area!",void console.log(n,t,i);var l=i.a2+(180-i.a1),u=360-l;return Math.abs(l)<30||Math.abs(u)<30?(n="ERROR: Conversion failed: GCODE causes arms to cross!",void console.log(n,t,i,l,u)):i},o=a(t.X,t.Y);if(void 0==o&&(o=a(t.X,t.Y,!0)),void 0==o)throw this.error_reporter(n),n;return o.a1=parseFloat(o.a1.toFixed(2)),o.a2=parseFloat(o.a2.toFixed(2)),o.Z=t.Z,o.E=t.E,this.last_hand=o.hand,o}},{key:"cartesian_to_scara_feedrate",value:function(t,e,n){var a=this.scara_props.L1,o=this.scara_props.L2,r=this.pref_hand,i=Math.sqrt(Math.pow(e.X-t.X,2)+Math.pow(e.Y-t.Y,2));if(0===i)return 0;var s=(e.X-t.X)/i*n,c=(e.Y-t.Y)/i*n,l=Math.sqrt(Math.pow(t.X,2)+Math.pow(t.Y,2)),u=(t.X*s+t.Y*c)/Math.sqrt(Math.pow(t.X,2)+Math.pow(t.Y,2)),d=(t.X*c-t.Y*s)/Math.pow(l,2),h=d-r*u*(2*Math.pow(l,2)*a-Math.pow(l,2)-Math.pow(a,2)+Math.pow(o,2))/(2*Math.pow(l,2)*Math.pow(a,2))*Math.sqrt(1-(Math.pow(l,2)+Math.pow(a,2)-Math.pow(o,2))/(2*l*a)),p=d+r*u*(2*Math.pow(l,2)*o-Math.pow(l,2)-Math.pow(o,2)+Math.pow(a,2))/(2*Math.pow(l,2)*Math.pow(o,2))*Math.sqrt(1-(Math.pow(l,2)+Math.pow(o,2)-Math.pow(a,2))/(2*l*o)),g=Math.sqrt(Math.pow(h,2)+Math.pow(p,2));return parseFloat(Math.min(Math.abs(180*Math.round(g)/Math.PI),this.scara_props.max_speed).toFixed(1))}},{key:"interpolate",value:function(t,e,n,a){return{X:(n*e.X+(a-n)*t.X)/a,Y:(n*e.Y+(a-n)*t.Y)/a,Z:(n*e.Z+(a-n)*t.Z)/a,E:(n*e.E+(a-n)*t.E)/a,F:this.feed_rate}}},{key:"segmentize_cartesian_to_scara",value:function(t,e){var n=this,a=this.scara_distance(this.map_cartesian_to_scara(t),this.map_cartesian_to_scara(e));if(a<=this.max_seg_length)return[this.map_cartesian_to_scara(e)];var o=Math.round(Math.ceil(a/this.max_seg_length));return Array(o).fill(0).map((function(a,r){return n.map_cartesian_to_scara(n.interpolate(t,e,r+1,o))}))}},{key:"translate",value:function(t){var e=Kt({},t),n=(Math.hypot(t.X,t.Y),Math.atan2(t.Y,t.X));this.skew;return e.X=t.X+this.x_offset,e.Y=t.Y+this.y_offset,e}},{key:"plot_scara_move",value:function(t,e){var n=[],a=ee.parseLine(t);if(0===a.words.length)return[[],e];if("G"===a.words[0][0]&&[0,1].includes(a.words[0][1])||!["G","M"].includes(a.words[0][0])){var o=!1;"G"===a.words[0][0]&&0===a.words[0][1]&&(o=!0);var r=this.parse_gcode_move(a.words);if(r.Y=r.Y+this.inner_rad,isNaN(r.X)&&(r.X=e.X),isNaN(r.Y)&&(r.Y=e.Y),isNaN(r.Z)&&(r.Z=e.Z),isNaN(r.E)&&(r.E=e.E),isNaN(r.F)&&(r.F=e.F),r.X===e.X&&r.Y===e.Y)return r.Z!==e.Z&&n.push("G1 Z".concat(r.Z," F").concat(r.F)),[n,r];if(void 0===e.X&&void 0===e.Y||o){var i=this.translate(e);return n.push("G0 X".concat(i.X," Y").concat(i.Y," Z").concat(i.Z," F").concat(i.F)),[n,r]}var s=this.translate(e);return n.push("G1 X".concat(s.X," Y").concat(s.Y," Z").concat(s.Z," F").concat(s.F)),[n,r]}return"G"===a.words[0][0]&&92.1===a.words[0][1]?[[],{X:0,Y:0,Z:0,E:0,F:e.F}]:[["(unable to parse line: ".concat(t,")")],e]}},{key:"convert_cartesian_to_scara",value:function(t){var e=this;t=t.replace(/[N]\d+(?= [^G])/g,"G1"),t=t.replace(/[N]\d+ /g,"");var n=t.split("\n"),a={X:void 0,Y:void 0,Z:0,F:this.feed_rate},o=n.reduce((function(t,n){var o=[],r=e.plot_scara_move(n,a),i=Object(G["a"])(r,2);return o=i[0],a=i[1],t.concat(o)}),[]);return o.join("\n")}}]),t}(),oe=a["default"].extend({data:function(){return{scara:new ae}},methods:{download_gcode:function(t,e){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)},load_gcode_file:function(t){var e=this,n=new FileReader;n.onload=function(n){e.download_gcode("".concat(t.name.replace(".gcode","").replace(".nc",""),"_converted.gcode"),e.scara.convert_cartesian_to_scara(n.target.result))},n.readAsText(t)}},mounted:function(){}}),re=oe,ie=(n("b396"),Object(u["a"])(re,Ht,Wt,!1,null,"56b51dc2",null)),se=ie.exports;h()(ie,{VFileInput:kt["a"]});var ce=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-slider",{staticStyle:{padding:"10px 24px"},attrs:{min:"-80",max:"80","thumb-label":"",label:"Arm 1 Angle:"},on:{input:t.plotScara},model:{value:t.a1,callback:function(e){t.a1=e},expression:"a1"}}),n("v-slider",{staticStyle:{padding:"10px 24px"},attrs:{min:"-80",max:"80","thumb-label":"",label:"Arm 2 Angle:"},on:{input:t.plotScara},model:{value:t.a2,callback:function(e){t.a2=e},expression:"a2"}}),n("div",{staticStyle:{border:"1px dotted #222"}},[n("svg",{attrs:{width:t.width,height:t.height}})])],1)},le=[],ue=Object.assign({},n("fd32"),n("f1df"),n("ce24"),n("4611"),n("bc17"),n("a1eb")),de=a["default"].extend({data:function(){return{a1:0,a2:0,width:500,height:500,padding:{top:30,right:30,bottom:60,left:60},plot_area:{width:400,height:400}}},methods:{plotScara:function(){var t=ue.select(this.$el).select("svg");if(t.selectAll("*").remove(),void 0!==t){var e=t.append("g");e.attr("width",this.width-this.padding.left-this.padding.right).attr("height",this.height-this.padding.top-this.padding.bottom).attr("transform","translate("+this.padding.left+","+this.padding.top+")").attr("class","davenport-plot-area");var n=ue.scaleLinear().domain([0,this.plot_area.width]).range([0,this.width-this.padding.left-this.padding.right]);e.append("g").attr("transform","translate(0,"+(this.height-this.padding.bottom-10)+")").call(ue.axisBottom(n));var a=ue.scaleLinear().domain([0,this.plot_area.height]).range([this.height-this.padding.top-this.padding.bottom,0]);e.append("g").call(ue.axisLeft().scale(a));var o=90,r=90,i=this.plot_area.width/2+Math.cos((this.a1+o)*Math.PI/180)*ne.L1,s=Math.sin((this.a1+o)*Math.PI/180)*ne.L1;e.append("line").attr("x1",n(this.plot_area.width/2)).attr("x2",n(i)).attr("y1",a(0)).attr("y2",a(s)).attr("stroke","coral").attr("stroke-width",20).attr("stroke-linecap","round");var c=i+Math.cos((this.a2+r)*Math.PI/180)*ne.L2,l=s+Math.sin((this.a2+r)*Math.PI/180)*ne.L2;e.append("line").attr("x1",n(i)).attr("x2",n(c)).attr("y1",a(s)).attr("y2",a(l)).attr("stroke","teal").attr("stroke-width",20).attr("stroke-linecap","round")}}},mounted:function(){var t=this;this.$nextTick((function(){t.plotScara()}))}}),he=de,pe=Object(u["a"])(he,ce,le,!1,null,null,null),ge=pe.exports;h()(pe,{VSlider:D["a"]}),a["default"].use(R["a"]);var ve=[{path:"/",name:"home",component:Ut},{path:"/scara",name:"SCARA",component:se},{path:"/sim",name:"sim",component:ge}],fe=new R["a"]({mode:"history",base:"/jscara-console/",routes:ve}),_e=fe,me=n("2f62");a["default"].use(me["a"]);var be=new me["a"].Store({state:{},mutations:{},actions:{},modules:{}}),we=n("9483");Object(we["a"])("".concat("/jscara-console/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var ye=n("ce5b"),xe=n.n(ye),ke=(n("bf40"),n("87f6")),Me=n.n(ke);a["default"].use(xe.a),a["default"].use(Me.a,{showClose:!1,color:"#403e4d"});var Se=new xe.a({theme:{dark:!0}}),Ce=n("8c2c");a["default"].config.productionTip=!1,a["default"].config.ignoredElements=["a-scene","a-assets","a-sky","a-camera","a-cursor","a-animation","a-entity","a-box","a-cylinder","a-plane"],a["default"].component("drr",Ce["a"]),new a["default"]({router:_e,store:be,vuetify:Se,render:function(t){return t(j)}}).$mount("#app")},fa53:function(t,e,n){"use strict";var a=n("82ec"),o=n.n(a);o.a}});
//# sourceMappingURL=app.c70dc6f8.js.map